(function(ce,Mt){typeof exports=="object"&&typeof module<"u"?Mt(exports):typeof define=="function"&&define.amd?define(["exports"],Mt):(ce=typeof globalThis<"u"?globalThis:ce||self,Mt(ce.papi={}))})(this,function(ce){"use strict";var Mt=Object.defineProperty,lc=(e,t,n)=>t in e?Mt(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,rs=(e,t,n)=>(lc(e,typeof t!="symbol"?t+"":t,n),n),Nn={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,a:10,b:11,c:12,d:13,e:14,f:15,A:10,B:11,C:12,D:13,E:14,F:15};function fc(e){const t=e.length%2,n=(e[1]==="x"?2:0)+t,r=(e.length-n)/2+t,s=new Uint8Array(r);t&&(s[0]=0|Nn[e[2]]);for(let o=0;o<r;){const i=n+o*2,c=Nn[e[i]],u=Nn[e[i+1]];s[t+o++]=c<<4|u}return s}var ss=class extends Uint8Array{constructor(e){super(e),rs(this,"i",0),rs(this,"v"),this.v=new DataView(e)}},Se=e=>t=>e(t instanceof ss?t:new ss(t instanceof Uint8Array?t.buffer:typeof t=="string"?fc(t).buffer:t)),De=e=>{const t=e.length;let n=0;for(let s=0;s<t;s++)n+=e[s].length;const r=new Uint8Array(n);for(let s=0,o=0;s<t;s++){const i=e[s];r.set(i,o),o+=i.byteLength}return r};function un(e,t){const n=Object.keys(e),r=n.length,s={};for(let o=0;o<r;o++){const i=n[o];s[i]=t(e[i],i)}return s}var ln=Se,j=(e,t)=>{const n=[e,t];return n.enc=e,n.dec=t,n},Lt=(e,t)=>n=>e(t(n)),Qn=(e,t)=>n=>t(e(n)),Ke=([e,t],n,r)=>j(Lt(e,n),Qn(t,r));function hc(e,t){return Se(n=>{const r=n.v[t](n.i,!0);return n.i+=e,r})}function dc(e,t){return n=>{const r=new Uint8Array(e);return new DataView(r.buffer)[t](0,n,!0),r}}function et(e,t,n){return j(dc(e,n),hc(e,t))}var F=et(1,"getUint8","setUint8"),tt=et(2,"getUint16","setUint16"),Te=et(4,"getUint32","setUint32"),Vt=et(8,"getBigUint64","setBigUint64"),pc=et(1,"getInt8","setInt8"),vc=et(2,"getInt16","setInt16"),bc=et(4,"getInt32","setInt32"),yc=et(8,"getBigInt64","setBigInt64"),os=e=>{const t=new Uint8Array(16),n=new DataView(t.buffer);return n.setBigInt64(0,e,!0),n.setBigInt64(8,e>>64n,!0),t},is=e=>Se(t=>{const{v:n,i:r}=t,s=n.getBigUint64(r,!0),o=n[e](r+8,!0);return t.i+=16,o<<64n|s}),cs=j(os,is("getBigUint64")),mc=j(os,is("getBigInt64")),as=e=>{const t=new Uint8Array(32),n=new DataView(t.buffer);return n.setBigInt64(0,e,!0),n.setBigInt64(8,e>>64n,!0),n.setBigInt64(16,e>>128n,!0),n.setBigInt64(24,e>>192n,!0),t},us=e=>Se(t=>{let n=t.v.getBigUint64(t.i,!0);return t.i+=8,n|=t.v.getBigUint64(t.i,!0)<<64n,t.i+=8,n|=t.v.getBigUint64(t.i,!0)<<128n,t.i+=8,n|=t.v[e](t.i,!0)<<192n,t.i+=8,n}),gc=j(as,us("getBigUint64")),wc=j(as,us("getBigInt64")),xc=Ke(F,e=>e?1:0,Boolean),Ec=[F[1],tt[1],Te[1]],kc=Se(e=>{const t=e[e.i],n=t&3;if(n<3)return Ec[n](e)>>>2;const r=(t>>>2)+4;e.i++;let s=0n;const o=r/8|0;let i=0n;for(let u=0;u<o;u++)s=Vt[1](e)<<i|s,i+=64n;let c=r%8;return c>3&&(s=BigInt(Te[1](e))<<i|s,i+=32n,c-=4),c>1&&(s=BigInt(tt[1](e))<<i|s,i+=16n,c-=2),c&&(s=BigInt(F[1](e))<<i|s),s}),Ac=1n<<56n,Sc=1<<24,Ic=256,Bc=4294967295n,_c=64,Cc=16384,$c=1<<30,Oc=e=>{if(e<0)throw new Error(`Wrong compact input (${e})`);const t=Number(e)<<2;if(e<_c)return F[0](t);if(e<Cc)return tt[0](t|1);if(e<$c)return Te[0](t|2);let n=[new Uint8Array(1)],r=BigInt(e);for(;r>=Ac;)n.push(Vt[0](r)),r>>=64n;r>=Sc&&(n.push(Te[0](Number(r&Bc))),r>>=32n);let s=Number(r);s>=Ic&&(n.push(tt[0](s)),s>>=16),s&&n.push(F[0](s));const o=De(n);return o[0]=o.length-5<<2|3,o},ae=j(Oc,kc),Tc=new TextEncoder,Pc=e=>{const t=Tc.encode(e);return De([ae.enc(t.length),t])},Rc=new TextDecoder,Uc=Se(e=>{let t=ae.dec(e);const n=new DataView(e.buffer,e.i,t);return e.i+=t,Rc.decode(n)}),V=j(Pc,Uc),Mc=()=>{},Lc=new Uint8Array(0),$=j(()=>Lc,Mc),ls=e=>e===void 0?t=>De([ae.enc(t.length),t]):t=>t.length===e?t:t.slice(0,e),fs=e=>Se(t=>{const n=e===void 0?ae.dec(t):e!==1/0?e:t.byteLength-t.i,r=new Uint8Array(t.buffer.slice(t.i,t.i+n));return t.i+=n,r}),Z=e=>j(ls(e),fs(e));Z.enc=ls,Z.dec=fs;var hs=(e,t)=>{const n=Object.keys(e),r=new Map(t?.map((o,i)=>[n[i],o])??n.map((o,i)=>[o,i])),s=o=>r.get(o);return({tag:o,value:i})=>De([F.enc(s(o)),e[o](i)])},ds=(e,t)=>{const n=Object.keys(e),r=new Map(t?.map((s,o)=>[s,n[o]])??n.map((s,o)=>[o,s]));return Se(s=>{const o=F.dec(s),i=r.get(o),c=e[i];return{tag:i,value:c(s)}})},he=(e,...t)=>j(hs(un(e,([n])=>n),...t),ds(un(e,([,n])=>n),...t));he.enc=hs,he.dec=ds;var ps=e=>Se(t=>F[1](t)>0?e(t):void 0),vs=e=>t=>{const n=new Uint8Array(1);return t===void 0?n:(n[0]=1,De([n,e(t)]))},de=e=>j(vs(e[0]),ps(e[1]));de.enc=vs,de.dec=ps;var bs=(e,t)=>Se(n=>{const r=F[1](n)===0,o=(r?e:t)(n);return{success:r,value:o}}),ys=(e,t)=>({success:n,value:r})=>De([F[0](n?0:1),(n?e:t)(r)]),Dt=(e,t)=>j(ys(e[0],t[0]),bs(e[1],t[1]));Dt.dec=bs,Dt.enc=ys;var ms=(...e)=>Se(t=>e.map(n=>n(t))),gs=(...e)=>t=>De(e.map((n,r)=>n(t[r]))),Ie=(...e)=>j(gs(...e.map(([t])=>t)),ms(...e.map(([,t])=>t)));Ie.enc=gs,Ie.dec=ms;var ws=e=>{const t=Object.keys(e);return Lt(Ie.enc(...Object.values(e)),n=>t.map(r=>n[r]))},xs=e=>{const t=Object.keys(e);return Qn(Ie.dec(...Object.values(e)),n=>Object.fromEntries(n.map((r,s)=>[t[s],r])))},O=e=>j(ws(un(e,t=>t[0])),xs(un(e,t=>t[1])));O.enc=ws,O.dec=xs;var Es=(e,t)=>t>=0?n=>De(n.map(e)):n=>De([ae.enc(n.length),De(n.map(e))]),ks=(e,t)=>Se(n=>{const r=t>=0?t:ae.dec(n),s=new Array(r);for(let o=0;o<r;o++)s[o]=e(n);return s}),R=(e,t)=>j(Es(e[0],t),ks(e[1],t));R.enc=Es,R.dec=ks;/*! scure-base - MIT License (c) 2022 Paul Miller (paulmillr.com) */function Vc(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&e.constructor.name==="Uint8Array"}function As(e,t){return Array.isArray(t)?t.length===0?!0:e?t.every(n=>typeof n=="string"):t.every(n=>Number.isSafeInteger(n)):!1}function Zn(e,t){if(typeof t!="string")throw new Error(`${e}: string expected`);return!0}function Ss(e){if(!Number.isSafeInteger(e))throw new Error(`invalid integer: ${e}`)}function Jn(e){if(!Array.isArray(e))throw new Error("array expected")}function Is(e,t){if(!As(!0,t))throw new Error(`${e}: array of strings expected`)}function Dc(e,t){if(!As(!1,t))throw new Error(`${e}: array of numbers expected`)}function jc(...e){const t=o=>o,n=(o,i)=>c=>o(i(c)),r=e.map(o=>o.encode).reduceRight(n,t),s=e.map(o=>o.decode).reduce(n,t);return{encode:r,decode:s}}function Fc(e){const t=typeof e=="string"?e.split(""):e,n=t.length;Is("alphabet",t);const r=new Map(t.map((s,o)=>[s,o]));return{encode:s=>(Jn(s),s.map(o=>{if(!Number.isSafeInteger(o)||o<0||o>=n)throw new Error(`alphabet.encode: digit index outside alphabet "${o}". Allowed: ${e}`);return t[o]})),decode:s=>(Jn(s),s.map(o=>{Zn("alphabet.decode",o);const i=r.get(o);if(i===void 0)throw new Error(`Unknown letter: "${o}". Allowed: ${e}`);return i}))}}function zc(e=""){return Zn("join",e),{encode:t=>(Is("join.decode",t),t.join(e)),decode:t=>(Zn("join.decode",t),t.split(e))}}function Bs(e,t,n){if(t<2)throw new Error(`convertRadix: invalid from=${t}, base cannot be less than 2`);if(n<2)throw new Error(`convertRadix: invalid to=${n}, base cannot be less than 2`);if(Jn(e),!e.length)return[];let r=0;const s=[],o=Array.from(e,c=>{if(Ss(c),c<0||c>=t)throw new Error(`invalid integer: ${c}`);return c}),i=o.length;for(;;){let c=0,u=!0;for(let l=r;l<i;l++){const h=o[l],d=t*c,a=d+h;if(!Number.isSafeInteger(a)||d/t!==c||a-h!==d)throw new Error("convertRadix: carry overflow");const f=a/n;c=a%n;const p=Math.floor(f);if(o[l]=p,!Number.isSafeInteger(p)||p*n+c!==a)throw new Error("convertRadix: carry overflow");if(u)p?u=!1:r=l;else continue}if(s.push(c),u)break}for(let c=0;c<e.length-1&&e[c]===0;c++)s.push(0);return s.reverse()}function Hc(e){Ss(e);const t=2**8;return{encode:n=>{if(!Vc(n))throw new Error("radix.encode input should be Uint8Array");return Bs(Array.from(n),t,e)},decode:n=>(Dc("radix.decode",n),Uint8Array.from(Bs(n,e,t)))}}const _s=(e=>jc(Hc(58),Fc(e),zc("")))("123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz");/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */function qc(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&e.constructor.name==="Uint8Array"}function kt(e){if(!Number.isSafeInteger(e)||e<0)throw new Error("positive integer expected, got "+e)}function ht(e,...t){if(!qc(e))throw new Error("Uint8Array expected");if(t.length>0&&!t.includes(e.length))throw new Error("Uint8Array expected of length "+t+", got length="+e.length)}function jt(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function er(e,t){ht(e);const n=t.outputLen;if(e.length<n)throw new Error("digestInto() expects output buffer of length at least "+n)}function Wc(e){return new Uint8Array(e.buffer,e.byteOffset,e.byteLength)}function dt(e){return new Uint32Array(e.buffer,e.byteOffset,Math.floor(e.byteLength/4))}function nt(...e){for(let t=0;t<e.length;t++)e[t].fill(0)}function fn(e,t){return e<<32-t|e>>>t}const Cs=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;function $s(e){return e<<24&4278190080|e<<8&16711680|e>>>8&65280|e>>>24&255}const Xe=Cs?e=>e:e=>$s(e);function Kc(e){for(let t=0;t<e.length;t++)e[t]=$s(e[t]);return e}const ue=Cs?e=>e:Kc;function Xc(e){if(typeof e!="string")throw new Error("string expected");return new Uint8Array(new TextEncoder().encode(e))}function je(e){return typeof e=="string"&&(e=Xc(e)),ht(e),e}class Os{}function Yc(e){const t=r=>e().update(je(r)).digest(),n=e();return t.outputLen=n.outputLen,t.blockLen=n.blockLen,t.create=()=>e(),t}function Gc(e){const t=(r,s)=>e(s).update(je(r)).digest(),n=e({});return t.outputLen=n.outputLen,t.blockLen=n.blockLen,t.create=r=>e(r),t}function Nc(e){const t=(r,s)=>e(s).update(je(r)).digest(),n=e({});return t.outputLen=n.outputLen,t.blockLen=n.blockLen,t.create=r=>e(r),t}const Qc=Uint8Array.from([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9,12,5,1,15,14,13,4,10,0,7,6,3,9,2,8,11,13,11,7,14,12,1,3,9,5,0,15,4,8,6,2,10,6,15,14,9,11,3,0,8,12,2,13,7,1,4,10,5,10,2,8,4,7,6,1,5,15,11,9,14,3,12,13,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9]);function rt(e,t,n,r,s){return e=e+t+s|0,r=fn(r^e,16),n=n+r|0,t=fn(t^n,12),{a:e,b:t,c:n,d:r}}function st(e,t,n,r,s){return e=e+t+s|0,r=fn(r^e,8),n=n+r|0,t=fn(t^n,7),{a:e,b:t,c:n,d:r}}const Zc=Uint32Array.from([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),hn=BigInt(2**32-1),Ts=BigInt(32);function dn(e,t=!1){return t?{h:Number(e&hn),l:Number(e>>Ts&hn)}:{h:Number(e>>Ts&hn)|0,l:Number(e&hn)|0}}function Jc(e,t=!1){const n=e.length;let r=new Uint32Array(n),s=new Uint32Array(n);for(let o=0;o<n;o++){const{h:i,l:c}=dn(e[o],t);[r[o],s[o]]=[i,c]}return[r,s]}const Ps=(e,t,n)=>e>>>n|t<<32-n,Rs=(e,t,n)=>e<<32-n|t>>>n,ea=(e,t,n)=>e<<64-n|t>>>n-32,ta=(e,t,n)=>e>>>n-32|t<<64-n,na=(e,t)=>t,ra=(e,t)=>e,sa=(e,t,n)=>e<<n|t>>>32-n,oa=(e,t,n)=>t<<n|e>>>32-n,ia=(e,t,n)=>t<<n-32|e>>>64-n,ca=(e,t,n)=>e<<n-32|t>>>64-n;function Us(e,t,n,r){const s=(t>>>0)+(r>>>0);return{h:e+n+(s/2**32|0)|0,l:s|0}}const Ms=(e,t,n)=>(e>>>0)+(t>>>0)+(n>>>0),Ls=(e,t,n,r)=>t+n+r+(e/2**32|0)|0,Q=Uint32Array.from([4089235720,1779033703,2227873595,3144134277,4271175723,1013904242,1595750129,2773480762,2917565137,1359893119,725511199,2600822924,4215389547,528734635,327033209,1541459225]),A=new Uint32Array(32);function ot(e,t,n,r,s,o){const i=s[o],c=s[o+1];let u=A[2*e],l=A[2*e+1],h=A[2*t],d=A[2*t+1],a=A[2*n],f=A[2*n+1],p=A[2*r],v=A[2*r+1],b=Ms(u,h,i);l=Ls(b,l,d,c),u=b|0,{Dh:v,Dl:p}={Dh:v^l,Dl:p^u},{Dh:v,Dl:p}={Dh:na(v,p),Dl:ra(v)},{h:f,l:a}=Us(f,a,v,p),{Bh:d,Bl:h}={Bh:d^f,Bl:h^a},{Bh:d,Bl:h}={Bh:Ps(d,h,24),Bl:Rs(d,h,24)},A[2*e]=u,A[2*e+1]=l,A[2*t]=h,A[2*t+1]=d,A[2*n]=a,A[2*n+1]=f,A[2*r]=p,A[2*r+1]=v}function it(e,t,n,r,s,o){const i=s[o],c=s[o+1];let u=A[2*e],l=A[2*e+1],h=A[2*t],d=A[2*t+1],a=A[2*n],f=A[2*n+1],p=A[2*r],v=A[2*r+1],b=Ms(u,h,i);l=Ls(b,l,d,c),u=b|0,{Dh:v,Dl:p}={Dh:v^l,Dl:p^u},{Dh:v,Dl:p}={Dh:Ps(v,p,16),Dl:Rs(v,p,16)},{h:f,l:a}=Us(f,a,v,p),{Bh:d,Bl:h}={Bh:d^f,Bl:h^a},{Bh:d,Bl:h}={Bh:ea(d,h,63),Bl:ta(d,h,63)},A[2*e]=u,A[2*e+1]=l,A[2*t]=h,A[2*t+1]=d,A[2*n]=a,A[2*n+1]=f,A[2*r]=p,A[2*r+1]=v}function aa(e,t={},n,r,s){if(kt(n),e<0||e>n)throw new Error("outputLen bigger than keyLen");const{key:o,salt:i,personalization:c}=t;if(o!==void 0&&(o.length<1||o.length>n))throw new Error("key length must be undefined or 1.."+n);if(i!==void 0&&i.length!==r)throw new Error("salt must be undefined or "+r);if(c!==void 0&&c.length!==s)throw new Error("personalization must be undefined or "+s)}class Vs extends Os{constructor(t,n){super(),this.finished=!1,this.destroyed=!1,this.length=0,this.pos=0,kt(t),kt(n),this.blockLen=t,this.outputLen=n,this.buffer=new Uint8Array(t),this.buffer32=dt(this.buffer)}update(t){jt(this),t=je(t),ht(t);const{blockLen:n,buffer:r,buffer32:s}=this,o=t.length,i=t.byteOffset,c=t.buffer;for(let u=0;u<o;){this.pos===n&&(ue(s),this.compress(s,0,!1),ue(s),this.pos=0);const l=Math.min(n-this.pos,o-u),h=i+u;if(l===n&&!(h%4)&&u+l<o){const d=new Uint32Array(c,h,Math.floor((o-u)/4));ue(d);for(let a=0;u+n<o;a+=s.length,u+=n)this.length+=n,this.compress(d,a,!1);ue(d);continue}r.set(t.subarray(u,u+l),this.pos),this.pos+=l,this.length+=l,u+=l}return this}digestInto(t){jt(this),er(t,this);const{pos:n,buffer32:r}=this;this.finished=!0,nt(this.buffer.subarray(n)),ue(r),this.compress(r,0,!0),ue(r);const s=dt(t);this.get().forEach((o,i)=>s[i]=Xe(o))}digest(){const{buffer:t,outputLen:n}=this;this.digestInto(t);const r=t.slice(0,n);return this.destroy(),r}_cloneInto(t){const{buffer:n,length:r,finished:s,destroyed:o,outputLen:i,pos:c}=this;return t||(t=new this.constructor({dkLen:i})),t.set(...this.get()),t.buffer.set(n),t.destroyed=o,t.finished=s,t.length=r,t.pos=c,t.outputLen=i,t}clone(){return this._cloneInto()}}class ua extends Vs{constructor(t={}){const n=t.dkLen===void 0?64:t.dkLen;super(128,n),this.v0l=Q[0]|0,this.v0h=Q[1]|0,this.v1l=Q[2]|0,this.v1h=Q[3]|0,this.v2l=Q[4]|0,this.v2h=Q[5]|0,this.v3l=Q[6]|0,this.v3h=Q[7]|0,this.v4l=Q[8]|0,this.v4h=Q[9]|0,this.v5l=Q[10]|0,this.v5h=Q[11]|0,this.v6l=Q[12]|0,this.v6h=Q[13]|0,this.v7l=Q[14]|0,this.v7h=Q[15]|0,aa(n,t,64,16,16);let{key:r,personalization:s,salt:o}=t,i=0;if(r!==void 0&&(r=je(r),i=r.length),this.v0l^=this.outputLen|i<<8|65536|1<<24,o!==void 0){o=je(o);const c=dt(o);this.v4l^=Xe(c[0]),this.v4h^=Xe(c[1]),this.v5l^=Xe(c[2]),this.v5h^=Xe(c[3])}if(s!==void 0){s=je(s);const c=dt(s);this.v6l^=Xe(c[0]),this.v6h^=Xe(c[1]),this.v7l^=Xe(c[2]),this.v7h^=Xe(c[3])}if(r!==void 0){const c=new Uint8Array(this.blockLen);c.set(r),this.update(c)}}get(){let{v0l:t,v0h:n,v1l:r,v1h:s,v2l:o,v2h:i,v3l:c,v3h:u,v4l:l,v4h:h,v5l:d,v5h:a,v6l:f,v6h:p,v7l:v,v7h:b}=this;return[t,n,r,s,o,i,c,u,l,h,d,a,f,p,v,b]}set(t,n,r,s,o,i,c,u,l,h,d,a,f,p,v,b){this.v0l=t|0,this.v0h=n|0,this.v1l=r|0,this.v1h=s|0,this.v2l=o|0,this.v2h=i|0,this.v3l=c|0,this.v3h=u|0,this.v4l=l|0,this.v4h=h|0,this.v5l=d|0,this.v5h=a|0,this.v6l=f|0,this.v6h=p|0,this.v7l=v|0,this.v7h=b|0}compress(t,n,r){this.get().forEach((u,l)=>A[l]=u),A.set(Q,16);let{h:s,l:o}=dn(BigInt(this.length));A[24]=Q[8]^o,A[25]=Q[9]^s,r&&(A[28]=~A[28],A[29]=~A[29]);let i=0;const c=Qc;for(let u=0;u<12;u++)ot(0,4,8,12,t,n+2*c[i++]),it(0,4,8,12,t,n+2*c[i++]),ot(1,5,9,13,t,n+2*c[i++]),it(1,5,9,13,t,n+2*c[i++]),ot(2,6,10,14,t,n+2*c[i++]),it(2,6,10,14,t,n+2*c[i++]),ot(3,7,11,15,t,n+2*c[i++]),it(3,7,11,15,t,n+2*c[i++]),ot(0,5,10,15,t,n+2*c[i++]),it(0,5,10,15,t,n+2*c[i++]),ot(1,6,11,12,t,n+2*c[i++]),it(1,6,11,12,t,n+2*c[i++]),ot(2,7,8,13,t,n+2*c[i++]),it(2,7,8,13,t,n+2*c[i++]),ot(3,4,9,14,t,n+2*c[i++]),it(3,4,9,14,t,n+2*c[i++]);this.v0l^=A[0]^A[16],this.v0h^=A[1]^A[17],this.v1l^=A[2]^A[18],this.v1h^=A[3]^A[19],this.v2l^=A[4]^A[20],this.v2h^=A[5]^A[21],this.v3l^=A[6]^A[22],this.v3h^=A[7]^A[23],this.v4l^=A[8]^A[24],this.v4h^=A[9]^A[25],this.v5l^=A[10]^A[26],this.v5h^=A[11]^A[27],this.v6l^=A[12]^A[28],this.v6h^=A[13]^A[29],this.v7l^=A[14]^A[30],this.v7h^=A[15]^A[31],nt(A)}destroy(){this.destroyed=!0,nt(this.buffer32),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}const la=Gc(e=>new ua(e));function Ds(e,t,n,r,s,o,i,c,u,l,h,d,a,f,p,v,b,y,g,w){let m=0;for(let x=0;x<r;x++)({a:s,b:u,c:a,d:b}=rt(s,u,a,b,n[t+e[m++]])),{a:s,b:u,c:a,d:b}=st(s,u,a,b,n[t+e[m++]]),{a:o,b:l,c:f,d:y}=rt(o,l,f,y,n[t+e[m++]]),{a:o,b:l,c:f,d:y}=st(o,l,f,y,n[t+e[m++]]),{a:i,b:h,c:p,d:g}=rt(i,h,p,g,n[t+e[m++]]),{a:i,b:h,c:p,d:g}=st(i,h,p,g,n[t+e[m++]]),{a:c,b:d,c:v,d:w}=rt(c,d,v,w,n[t+e[m++]]),{a:c,b:d,c:v,d:w}=st(c,d,v,w,n[t+e[m++]]),{a:s,b:l,c:p,d:w}=rt(s,l,p,w,n[t+e[m++]]),{a:s,b:l,c:p,d:w}=st(s,l,p,w,n[t+e[m++]]),{a:o,b:h,c:v,d:b}=rt(o,h,v,b,n[t+e[m++]]),{a:o,b:h,c:v,d:b}=st(o,h,v,b,n[t+e[m++]]),{a:i,b:d,c:a,d:y}=rt(i,d,a,y,n[t+e[m++]]),{a:i,b:d,c:a,d:y}=st(i,d,a,y,n[t+e[m++]]),{a:c,b:u,c:f,d:g}=rt(c,u,f,g,n[t+e[m++]]),{a:c,b:u,c:f,d:g}=st(c,u,f,g,n[t+e[m++]]);return{v0:s,v1:o,v2:i,v3:c,v4:u,v5:l,v6:h,v7:d,v8:a,v9:f,v10:p,v11:v,v12:b,v13:y,v14:g,v15:w}}const pn=la,js=new TextEncoder().encode("SS58PRE"),tr=2,nr=e=>{try{const t=_s.decode(e),n=t.subarray(0,t[0]&64?2:1),r=t.subarray(n.length,t.length-tr),s=t.subarray(n.length+r.length),o=pn(Uint8Array.of(...js,...n,...r),{dkLen:64}).subarray(0,tr);return s[0]===o[0]&&s[1]===o[1]?{isValid:!0,ss58Format:fa(n),publicKey:r.slice()}:{isValid:!1}}catch{return{isValid:!1}}},fa=e=>{const t=new DataView(e.buffer,e.byteOffset,e.byteLength);return t.byteLength===1?t.getUint8(0):t.getUint16(0)},Fs=e=>{const t=e<64?Uint8Array.of(e):Uint8Array.of((e&252)>>2|64,e>>8|(e&3)<<6);return n=>{const r=pn(Uint8Array.of(...js,...t,...n),{dkLen:64}).subarray(0,tr);return _s.encode(Uint8Array.of(...t,...n,...r))}};function ha(e,t){return n=>{const r=nr(n);if(!r.isValid)throw new Error("Invalid checksum");const{publicKey:s}=r;if(s.length!==e)throw new Error("Invalid public key length");return s}}const pt=(e=42,t=32)=>Ke(Z(t),ha(t),Fs(e)),zs="0123456789abcdef";function J(e){const t=new Array(e.length+1);t[0]="0x";for(let n=0;n<e.length;){const r=e[n++];t[n]=zs[r>>4]+zs[r&15]}return t.join("")}const rr={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,a:10,b:11,c:12,d:13,e:14,f:15,A:10,B:11,C:12,D:13,E:14,F:15};function le(e){const t=e.length%2,n=(e[1]==="x"?2:0)+t,r=(e.length-n)/2+t,s=new Uint8Array(r);t&&(s[0]=0|rr[e[2]]);for(let o=0;o<r;){const i=n+o*2,c=rr[e[i]],u=rr[e[i+1]];s[t+o++]=c<<4|u}return s}function At(e,t){return Object.fromEntries(Object.entries(e).map(([n,r])=>[n,t(r,n)]))}const re=(...e)=>{const t=e.reduce((r,s)=>r+s.byteLength,0),n=new Uint8Array(t);for(let r=0,s=0;r<e.length;r++){const o=e[r];n.set(o,s),s+=o.byteLength}return n},Ft=Function.prototype;class Hs extends Error{constructor(){super("Abort Error"),this.name="AbortError"}}var da=Object.defineProperty,qs=e=>{throw TypeError(e)},pa=(e,t,n)=>t in e?da(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,zt=(e,t,n)=>pa(e,typeof t!="symbol"?t+"":t,n),Ws=(e,t,n)=>t.has(e)||qs("Cannot "+n),Ye=(e,t,n)=>(Ws(e,t,"read from private field"),n?n.call(e):t.get(e)),Ht=(e,t,n)=>t.has(e)?qs("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,n),vt=(e,t,n,r)=>(Ws(e,t,"write to private field"),t.set(e,n),n),Ge,qt,vn,bn,yn;const va=new TextEncoder,ba=new TextDecoder,ya=Ie(ae,Z(1/0))[1];class Fe{constructor(t,n=!1){if(Ht(this,Ge),Ht(this,qt,null),Ht(this,vn,null),Ht(this,bn,null),Ht(this,yn,null),zt(this,"asText",()=>Ye(this,yn)??vt(this,yn,ba.decode(Ye(this,Ge)))),zt(this,"asHex",()=>Ye(this,vn)||vt(this,vn,J(Ye(this,Ge)))),zt(this,"asOpaqueHex",()=>Ye(this,bn)||vt(this,bn,J(this.asBytes()))),zt(this,"asBytes",()=>Ye(this,Ge)),zt(this,"asOpaqueBytes",()=>Ye(this,qt)||vt(this,qt,re(ae[0](Ye(this,Ge).length),Ye(this,Ge)))),n){try{const[r,s]=ya(t);if(r===s.length){vt(this,Ge,s),vt(this,qt,t);return}}catch{}throw new Error("Invalid opaque bytes")}else vt(this,Ge,t)}static fromText(t){return new this(va.encode(t))}static fromHex(t){return new this(le(t))}static fromOpaqueHex(t){return new this(le(t),!0)}static fromBytes(t){return new this(t)}static fromOpaqueBytes(t){return new this(t,!0)}}Ge=new WeakMap,qt=new WeakMap,vn=new WeakMap,bn=new WeakMap,yn=new WeakMap;const[ma]=pt();class mn extends Fe{constructor(t){super(t)}static fromArray(t){return new this(new Uint8Array(t))}static fromAccountId32(t){return new this(ma(t))}}const Ks=e=>{const t=Z.enc(e);return n=>t(n.asBytes())},Xs=e=>{const t=Z.dec(e),n=e==null?Fe:mn;return r=>n.fromBytes(t(r))},Wt=e=>j(Ks(e),Xs(e));Wt.enc=Ks,Wt.dec=Xs;const _=Ke(ae,e=>e,Number),gn=Ke(ae,e=>e,BigInt),ga=ln(e=>{const t=_.dec(e),n=Math.ceil(t/8);return{bytes:Z(n).dec(e),bitsLen:t}}),Ys=j(e=>{if(e.bitsLen>e.bytes.length*8)throw new Error(`Not enough bytes. (bitsLen:${e.bitsLen}, bytesLen:${e.bytes.length})`);const t=_.enc(e.bitsLen),n=new Uint8Array(e.bytes.length+t.length);return n.set(t,0),n.set(e.bytes,t.length),n},ga),wa=Ke(F,e=>e.charCodeAt(0),String.fromCharCode),Gs=e=>{const t=Z.enc(e);return n=>t(le(n))},Ns=e=>{const t=Z.dec(e);return n=>J(t(n))},Pe=e=>j(Gs(e),Ns(e));Pe.enc=Gs,Pe.dec=Ns;const xa=new TextEncoder,Ea=new TextDecoder,ka=e=>Ke(Z(e),t=>xa.encode(t),t=>Ea.decode(t)),Qs=e=>{let t=n=>{const r=e();return t=r,r(n)};return n=>t(n)},Zs=e=>{let t=n=>{const r=e(),s=r;return t=r,s(n)};return n=>t(n)},sr=e=>j(Qs(()=>e().enc),Zs(()=>e().dec)),bt=Object.assign((e,t)=>({type:e,value:t}),{is(e,t){return e.type===t},as(e,t){if(t!==e.type)throw new Error(`Enum.as(enum, ${t}) used with actual type ${e.type}`);return e}}),Js=new Proxy({},{get(e,t){return n=>bt(t,n)}}),Y=(e,t)=>{const n=e;return n.inner=t,n},eo=(...e)=>{const t=he.enc(...e);return Y(n=>t({tag:n.type,value:n.value}),e[0])},to=(...e)=>{const t=he.dec(...e);return Y(n=>{const{tag:r,value:s}=t(n);return bt(r,s)},e[0])},pe=(e,...t)=>Y(j(eo(At(e,([n])=>n),...t),to(At(e,([,n])=>n),...t)),e);pe.enc=eo,pe.dec=to;const or=(e,...t)=>Y(he(e,...t),e);or.enc=(e,...t)=>Y(he.enc(e,...t),e),or.dec=(e,...t)=>Y(he.dec(e,...t),e);const Aa=BigInt(0),Kt=BigInt(1),Sa=BigInt(2),Ia=BigInt(7),Ba=BigInt(256),_a=BigInt(113),no=[],ro=[],so=[];for(let e=0,t=Kt,n=1,r=0;e<24;e++){[n,r]=[r,(2*n+3*r)%5],no.push(2*(5*r+n)),ro.push((e+1)*(e+2)/2%64);let s=Aa;for(let o=0;o<7;o++)t=(t<<Kt^(t>>Ia)*_a)%Ba,t&Sa&&(s^=Kt<<(Kt<<BigInt(o))-Kt);so.push(s)}const oo=Jc(so,!0),Ca=oo[0],$a=oo[1],io=(e,t,n)=>n>32?ia(e,t,n):sa(e,t,n),co=(e,t,n)=>n>32?ca(e,t,n):oa(e,t,n);function Oa(e,t=24){const n=new Uint32Array(10);for(let r=24-t;r<24;r++){for(let i=0;i<10;i++)n[i]=e[i]^e[i+10]^e[i+20]^e[i+30]^e[i+40];for(let i=0;i<10;i+=2){const c=(i+8)%10,u=(i+2)%10,l=n[u],h=n[u+1],d=io(l,h,1)^n[c],a=co(l,h,1)^n[c+1];for(let f=0;f<50;f+=10)e[i+f]^=d,e[i+f+1]^=a}let s=e[2],o=e[3];for(let i=0;i<24;i++){const c=ro[i],u=io(s,o,c),l=co(s,o,c),h=no[i];s=e[h],o=e[h+1],e[h]=u,e[h+1]=l}for(let i=0;i<50;i+=10){for(let c=0;c<10;c++)n[c]=e[i+c];for(let c=0;c<10;c++)e[i+c]^=~n[(c+2)%10]&n[(c+4)%10]}e[0]^=Ca[r],e[1]^=$a[r]}nt(n)}class ir extends Os{constructor(t,n,r,s=!1,o=24){if(super(),this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,this.enableXOF=!1,this.blockLen=t,this.suffix=n,this.outputLen=r,this.enableXOF=s,this.rounds=o,kt(r),!(0<t&&t<200))throw new Error("only keccak-f1600 function is supported");this.state=new Uint8Array(200),this.state32=dt(this.state)}clone(){return this._cloneInto()}keccak(){ue(this.state32),Oa(this.state32,this.rounds),ue(this.state32),this.posOut=0,this.pos=0}update(t){jt(this),t=je(t),ht(t);const{blockLen:n,state:r}=this,s=t.length;for(let o=0;o<s;){const i=Math.min(n-this.pos,s-o);for(let c=0;c<i;c++)r[this.pos++]^=t[o++];this.pos===n&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;const{state:t,suffix:n,pos:r,blockLen:s}=this;t[r]^=n,(n&128)!==0&&r===s-1&&this.keccak(),t[s-1]^=128,this.keccak()}writeInto(t){jt(this,!1),ht(t),this.finish();const n=this.state,{blockLen:r}=this;for(let s=0,o=t.length;s<o;){this.posOut>=r&&this.keccak();const i=Math.min(r-this.posOut,o-s);t.set(n.subarray(this.posOut,this.posOut+i),s),this.posOut+=i,s+=i}return t}xofInto(t){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(t)}xof(t){return kt(t),this.xofInto(new Uint8Array(t))}digestInto(t){if(er(t,this),this.finished)throw new Error("digest() was already called");return this.writeInto(t),this.destroy(),t}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,nt(this.state)}_cloneInto(t){const{blockLen:n,suffix:r,outputLen:s,rounds:o,enableXOF:i}=this;return t||(t=new ir(n,r,s,i,o)),t.state32.set(this.state32),t.pos=this.pos,t.posOut=this.posOut,t.finished=this.finished,t.rounds=o,t.suffix=r,t.outputLen=s,t.enableXOF=i,t.destroyed=this.destroyed,t}}const Ta=(e,t,n)=>Yc(()=>new ir(t,e,n)),Pa=Ta(1,136,256/8),ao=e=>{const t=e.slice(2),n=J(Pa(t)).slice(2),r=new Array(40);for(let s=0;s<40;s++){const o=parseInt(n[s],16),i=t[s];r[s]=o>7?i.toUpperCase():i}return`0x${r.join("")}`},Ra=Z(20)[1],uo=j(e=>{const t=le(e);if(t.length!==20)throw new Error(`Invalid length found on EthAddress(${e})`);const n=J(t);if(e===n||e===n.toUpperCase())return t;if(ao(n)!==e)throw new Error(`Invalid checksum found on EthAddress(${e})`);return t},ln(e=>ao(J(Ra(e))))),me=e=>Y(O(e),e);me.enc=e=>Y(O.enc(e),e),me.dec=e=>Y(O.dec(e),e);const Re=(...e)=>Y(Ie(...e),e);Re.enc=(...e)=>Y(Ie.enc(...e),e),Re.dec=(...e)=>Y(Ie.dec(...e),e);const ge=(e,...t)=>Y(R(e,...t),e);ge.enc=(e,...t)=>Y(R.enc(e,...t),e),ge.dec=(e,...t)=>Y(R.dec(e,...t),e);const wn=(e,t)=>Y(Dt(e,t),{ok:e,ko:t});wn.enc=(e,t)=>Y(Dt.enc(e,t),{ok:e,ko:t}),wn.dec=(e,t)=>Y(Dt.dec(e,t),{ok:e,ko:t});const ct=e=>Y(de(e),e);ct.enc=e=>Y(de.enc(e),e),ct.dec=e=>Y(de.dec(e),e);const lo=new TextEncoder,fo=new TextDecoder,Ua=Ke(Z(4),lo.encode.bind(lo),fo.decode.bind(fo)),cr=me({engine:Ua,payload:Pe()}),Ma=pe({consensus:cr,seal:cr,preRuntime:cr,runtimeUpdated:$},[4,5,6,8]),ar=Pe(32),ho=me({parentHash:ar,number:_,stateRoot:ar,extrinsicRoot:ar,digests:ge(Ma)}),we=R(V),po=de(V),La=he({bool:$,char:$,str:$,u8:$,u16:$,u32:$,u64:$,u128:$,u256:$,i8:$,i16:$,i32:$,i64:$,i128:$,i256:$}),vo=R(O({name:po,type:_,typeName:po,docs:we})),Va=O({len:Te,type:_}),Da=O({bitStoreType:_,bitOrderType:_}),ja=R(O({name:V,fields:vo,index:F,docs:we})),Fa=he({composite:vo,variant:ja,sequence:_,array:Va,tuple:R(_),primitive:La,compact:_,bitSequence:Da}),za=O({name:V,type:de(_)}),Ha=R(za),qa=O({id:_,path:we,params:Ha,def:Fa,docs:we}),xn=R(qa),St=he({NotDeprecated:$,DeprecatedWithoutNote:$,Deprecated:O({note:V,since:de(V)})}),Wa=R(O({index:F,deprecation:he({DeprecatedWithoutNote:$,Deprecated:O({note:V,since:de(V)})},[1,2])})),ur={name:V,inputs:R(O({name:V,type:_})),output:_,docs:we},Ka=O({name:V,methods:R(O(ur)),docs:we}),Xa=O({name:V,methods:R(O({...ur,deprecationInfo:St})),docs:we,version:_,deprecationInfo:St}),Ya=O({id:Pe(32),...ur,deprecationInfo:St}),Ga=he({Blake2128:$,Blake2256:$,Blake2128Concat:$,Twox128:$,Twox256:$,Twox64Concat:$,Identity:$}),Na=R(Ga),Qa=O({hashers:Na,key:_,value:_}),bo={name:V,modifier:F,type:he({plain:_,map:Qa}),fallback:Pe(),docs:we},lr=de(_),yo={name:V,storage:de(O({prefix:V,items:R(O(bo))})),calls:lr,events:lr,constants:R(O({name:V,type:_,value:Pe(),docs:we})),errors:lr,index:F},Za={...yo,docs:we},fr=de(O({type:_,deprecationInfo:Wa})),Ja={name:V,storage:de(O({prefix:V,items:R(O({...bo,deprecationInfo:St}))})),calls:fr,events:fr,constants:R(O({name:V,type:_,value:Pe(),docs:we,deprecationInfo:St})),errors:fr,associatedTypes:R(O({name:V,type:_,docs:we})),viewFns:R(Ya),index:F,docs:we,deprecationInfo:St},eu=new Uint8Array,mo=e=>j(()=>eu,()=>e),tu=O({type:_,version:F,signedExtensions:R(O({identifier:V,type:_,additionalSigned:_}))}),go=O({lookup:xn,pallets:R(O({...yo,docs:mo([])})),extrinsic:tu,type:_,apis:mo([])}),nu=O({version:F,address:_,call:_,signature:_,extra:_,signedExtensions:R(O({identifier:V,type:_,additionalSigned:_}))}),wo=O({lookup:xn,pallets:R(O(Za)),extrinsic:nu,type:_,apis:R(Ka),outerEnums:O({call:_,event:_,error:_}),custom:R(Ie(V,O({type:_,value:Pe()})))}),ru=O({version:R(F),address:_,call:_,signature:_,signedExtensionsByVersion:R(Ie(F,R(_))),signedExtensions:R(O({identifier:V,type:_,additionalSigned:_}))}),xo=O({lookup:xn,pallets:R(O(Ja)),extrinsic:ru,apis:R(Xa),outerEnums:O({call:_,event:_,error:_}),custom:R(Ie(V,O({type:_,value:Pe()})))}),Eo=()=>{throw new Error("Unsupported metadata version!")},ve=j(Eo,Eo),yt=O({magicNumber:Te,metadata:he({v0:ve,v1:ve,v2:ve,v3:ve,v4:ve,v5:ve,v6:ve,v7:ve,v8:ve,v9:ve,v10:ve,v11:ve,v12:ve,v13:ve,v14:go,v15:wo,v16:xo})}),hr=Z(),su=de(hr),ou=Ie(ae,hr),dr=e=>{try{return yt.dec(e)}catch{}try{return yt.dec(su.dec(e))}catch{}try{return yt.dec(hr.dec(e))}catch{}try{return yt.dec(ou.dec(e)[1])}catch{}throw null},Xt=e=>{if("magicNumber"in e&&(e=e.metadata),"tag"in e){if(e.tag!=="v14"&&e.tag!=="v15"&&e.tag!=="v16")throw new Error("Only metadata 14, 15, and 16 are supported");e=e.value}if("signedExtensionsByVersion"in e.extrinsic)return{version:16,...e};if("custom"in e){const{lookup:s,extrinsic:o,custom:i,apis:c,pallets:u,outerEnums:l}=e;return{version:15,lookup:s,pallets:u.map(h=>({...h,calls:h.calls!=null?{type:h.calls}:void 0,events:h.events!=null?{type:h.events}:void 0,errors:h.errors!=null?{type:h.errors}:void 0,viewFns:[],associatedTypes:[]})),extrinsic:{...o,version:[o.version]},apis:c,outerEnums:l,custom:i}}const{lookup:t,extrinsic:n,pallets:r}=e;return{version:14,lookup:t,pallets:r.map(s=>({...s,calls:s.calls!=null?{type:s.calls}:void 0,events:s.events!=null?{type:s.events}:void 0,errors:s.errors!=null?{type:s.errors}:void 0,viewFns:[],associatedTypes:[]})),extrinsic:{...n,version:[n.version]},apis:[]}},iu={dkLen:32},Yt=e=>pn(e,iu),cu={dkLen:16},pr=e=>pn(e,cu),ko=e=>re(pr(e),e),ze={CHUNK_START:1,CHUNK_END:2,PARENT:4,ROOT:8,KEYED_HASH:16,DERIVE_KEY_CONTEXT:32,DERIVE_KEY_MATERIAL:64},Ne=Zc.slice(),Ao=(()=>{const e=Array.from({length:16},(r,s)=>s),t=r=>[2,6,3,10,7,0,4,13,1,11,12,5,9,14,15,8].map(s=>r[s]),n=[];for(let r=0,s=e;r<7;r++,s=t(s))n.push(...s);return Uint8Array.from(n)})();class vr extends Vs{constructor(t={},n=0){super(64,t.dkLen===void 0?32:t.dkLen),this.chunkPos=0,this.chunksDone=0,this.flags=0,this.stack=[],this.posOut=0,this.bufferOut32=new Uint32Array(16),this.chunkOut=0,this.enableXOF=!0;const{key:r,context:s}=t,o=s!==void 0;if(r!==void 0){if(o)throw new Error('Only "key" or "context" can be specified at same time');const i=je(r).slice();ht(i,32),this.IV=dt(i),ue(this.IV),this.flags=n|ze.KEYED_HASH}else if(o){const i=je(s),c=new vr({dkLen:32},ze.DERIVE_KEY_CONTEXT).update(i).digest();this.IV=dt(c),ue(this.IV),this.flags=n|ze.DERIVE_KEY_MATERIAL}else this.IV=Ne.slice(),this.flags=n;this.state=this.IV.slice(),this.bufferOut=Wc(this.bufferOut32)}get(){return[]}set(){}b2Compress(t,n,r,s=0){const{state:o,pos:i}=this,{h:c,l:u}=dn(BigInt(t),!0),{v0:l,v1:h,v2:d,v3:a,v4:f,v5:p,v6:v,v7:b,v8:y,v9:g,v10:w,v11:m,v12:x,v13:k,v14:B,v15:C}=Ds(Ao,s,r,7,o[0],o[1],o[2],o[3],o[4],o[5],o[6],o[7],Ne[0],Ne[1],Ne[2],Ne[3],c,u,i,n);o[0]=l^y,o[1]=h^g,o[2]=d^w,o[3]=a^m,o[4]=f^x,o[5]=p^k,o[6]=v^B,o[7]=b^C}compress(t,n=0,r=!1){let s=this.flags;if(this.chunkPos||(s|=ze.CHUNK_START),(this.chunkPos===15||r)&&(s|=ze.CHUNK_END),r||(this.pos=this.blockLen),this.b2Compress(this.chunksDone,s,t,n),this.chunkPos+=1,this.chunkPos===16||r){let o=this.state;this.state=this.IV.slice();for(let i,c=this.chunksDone+1;(r||!(c&1))&&(i=this.stack.pop());c>>=1)this.buffer32.set(i,0),this.buffer32.set(o,8),this.pos=this.blockLen,this.b2Compress(0,this.flags|ze.PARENT,this.buffer32,0),o=this.state,this.state=this.IV.slice();this.chunksDone++,this.chunkPos=0,this.stack.push(o)}this.pos=0}_cloneInto(t){t=super._cloneInto(t);const{IV:n,flags:r,state:s,chunkPos:o,posOut:i,chunkOut:c,stack:u,chunksDone:l}=this;return t.state.set(s.slice()),t.stack=u.map(h=>Uint32Array.from(h)),t.IV.set(n),t.flags=r,t.chunkPos=o,t.chunksDone=l,t.posOut=i,t.chunkOut=c,t.enableXOF=this.enableXOF,t.bufferOut32.set(this.bufferOut32),t}destroy(){this.destroyed=!0,nt(this.state,this.buffer32,this.IV,this.bufferOut32),nt(...this.stack)}b2CompressOut(){const{state:t,pos:n,flags:r,buffer32:s,bufferOut32:o}=this,{h:i,l:c}=dn(BigInt(this.chunkOut++));ue(s);const{v0:u,v1:l,v2:h,v3:d,v4:a,v5:f,v6:p,v7:v,v8:b,v9:y,v10:g,v11:w,v12:m,v13:x,v14:k,v15:B}=Ds(Ao,0,s,7,t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],Ne[0],Ne[1],Ne[2],Ne[3],c,i,n,r);o[0]=u^b,o[1]=l^y,o[2]=h^g,o[3]=d^w,o[4]=a^m,o[5]=f^x,o[6]=p^k,o[7]=v^B,o[8]=t[0]^b,o[9]=t[1]^y,o[10]=t[2]^g,o[11]=t[3]^w,o[12]=t[4]^m,o[13]=t[5]^x,o[14]=t[6]^k,o[15]=t[7]^B,ue(s),ue(o),this.posOut=0}finish(){if(this.finished)return;this.finished=!0,nt(this.buffer.subarray(this.pos));let t=this.flags|ze.ROOT;this.stack.length?(t|=ze.PARENT,ue(this.buffer32),this.compress(this.buffer32,0,!0),ue(this.buffer32),this.chunksDone=0,this.pos=this.blockLen):t|=(this.chunkPos?0:ze.CHUNK_START)|ze.CHUNK_END,this.flags=t,this.b2CompressOut()}writeInto(t){jt(this,!1),ht(t),this.finish();const{blockLen:n,bufferOut:r}=this;for(let s=0,o=t.length;s<o;){this.posOut>=n&&this.b2CompressOut();const i=Math.min(n-this.posOut,o-s);t.set(r.subarray(this.posOut,this.posOut+i),s),this.posOut+=i,s+=i}return t}xofInto(t){if(!this.enableXOF)throw new Error("XOF is not possible after digest call");return this.writeInto(t)}xof(t){return kt(t),this.xofInto(new Uint8Array(t))}digestInto(t){if(er(t,this),this.finished)throw new Error("digest() was already called");return this.enableXOF=!1,this.writeInto(t),this.destroy(),t}digest(){return this.digestInto(new Uint8Array(this.outputLen))}}const au=Nc(e=>new vr(e)),uu={dkLen:32},So=e=>au(e,uu),lu=e=>re(So(e),e),Io=e=>e,mt=(e,t,n,r)=>new DataView(new Uint16Array([e,t,n,r]).buffer).getBigUint64(0,!0),br=2n**64n-1n,se=(e,t)=>e<<t&br|e>>64n-t,L=(e,t)=>e*t&br,ee=(e,t)=>e+t&br,te=11400714785074694791n,xe=14029467366897019727n,Bo=1609587929392839161n,Gt=9650029242287828579n,_o=2870177450012600261n;function at(e,t=0n){let n=ee(ee(t,te),xe),r=ee(t,xe),s=t,o=t-te,i=e.length,c=0,u=null;(function(){let f=0,p=f+i;if(i){if(u=new Uint8Array(32),i<32){u.set(e.subarray(0,i),c),c+=i;return}if(f<=p-32){const v=p-32;do{let b;b=mt(e[f+1]<<8|e[f],e[f+3]<<8|e[f+2],e[f+5]<<8|e[f+4],e[f+7]<<8|e[f+6]),n=L(se(ee(n,L(b,xe)),31n),te),f+=8,b=mt(e[f+1]<<8|e[f],e[f+3]<<8|e[f+2],e[f+5]<<8|e[f+4],e[f+7]<<8|e[f+6]),r=L(se(ee(r,L(b,xe)),31n),te),f+=8,b=mt(e[f+1]<<8|e[f],e[f+3]<<8|e[f+2],e[f+5]<<8|e[f+4],e[f+7]<<8|e[f+6]),s=L(se(ee(s,L(b,xe)),31n),te),f+=8,b=mt(e[f+1]<<8|e[f],e[f+3]<<8|e[f+2],e[f+5]<<8|e[f+4],e[f+7]<<8|e[f+6]),o=L(se(ee(o,L(b,xe)),31n),te),f+=8}while(f<=v)}f<p&&(u.set(e.subarray(f,p),c),c=p-f)}})(),e=u||e;let l,h=0;for(i>=32?(l=se(n,1n),l=ee(l,se(r,7n)),l=ee(l,se(s,12n)),l=ee(l,se(o,18n)),n=L(se(L(n,xe),31n),te),l=l^n,l=ee(L(l,te),Gt),r=L(se(L(r,xe),31n),te),l=l^r,l=ee(L(l,te),Gt),s=L(se(L(s,xe),31n),te),l=l^s,l=ee(L(l,te),Gt),o=L(se(L(o,xe),31n),te),l=l^o,l=ee(L(l,te),Gt)):l=ee(t,_o),l=ee(l,BigInt(i));h<=c-8;){let a=mt(e[h+1]<<8|e[h],e[h+3]<<8|e[h+2],e[h+5]<<8|e[h+4],e[h+7]<<8|e[h+6]);a=L(se(L(a,xe),31n),te),l=ee(L(se(l^a,27n),te),Gt),h+=8}if(h+4<=c){let a=L(mt(e[h+1]<<8|e[h],e[h+3]<<8|e[h+2],0,0),te);l=ee(L(se(l^a,23n),xe),Bo),h+=4}for(;h<c;){const a=L(mt(e[h++],0,0,0),_o);l=L(se(l^a,11n),te)}let d=l>>33n;return l=L(l^d,xe),d=l>>29n,l=L(l^d,Bo),d=l>>32n,l^=d,l}const En=e=>{const t=new Uint8Array(16),n=new DataView(t.buffer);return n.setBigUint64(0,at(e),!0),n.setBigUint64(8,at(e,1n),!0),t},Co=e=>{const t=new Uint8Array(32),n=new DataView(t.buffer);return n.setBigUint64(0,at(e),!0),n.setBigUint64(8,at(e,1n),!0),n.setBigUint64(16,at(e,2n),!0),n.setBigUint64(24,at(e,3n),!0),t},$o=e=>re(Vt.enc(at(e)),e),Oo=new TextEncoder,fu=new Map([[Io,0],[$o,8],[ko,16],[pr,-16],[Yt,-32],[En,-16],[Co,-32]]),To=e=>{const t=En(Oo.encode(e));return(n,...r)=>{const s=re(t,En(Oo.encode(n))),o=J(s),i=l=>{if(!l.startsWith(o))throw new Error(`key does not match this storage (${e}.${n})`);if(r.length===0)return[];const h=le(l.slice(o.length)),d=new Array(r.length);for(let a=0,f=0;a<r.length;a++){const[p,v]=r[a],b=fu.get(v);if(b==null)throw new Error("Unknown hasher");if(b<0){const y=b*-1;d[a]=J(h.slice(f,f+y)),f+=y}else f+=b,d[a]=p.dec(h.slice(f)),f+=p.enc(d[a]).length}return d},c=r.map(([{enc:l},h])=>d=>h(l(d)));return{enc:(...l)=>J(re(s,...l.map((h,d)=>c[d](h)))),dec:i}}},hu=Fe.fromText("modlpy/utilisuba").asBytes(),du=({threshold:e,signatories:t})=>{const n=Po(t),r=re(hu,ae.enc(n.length),...n,tt.enc(e));return Yt(r)},Po=e=>e.slice().sort((t,n)=>{for(let r=0;;r++){const s=r>=t.length,o=r>=n.length;if(s&&o)return 0;if(s)return-1;if(o)return 1;if(t[r]!==n[r])return t[r]>n[r]?1:-1}});var Ro=Object.freeze({__proto__:null,AccountId:pt,Bin:Wt,Binary:Fe,Blake2128:pr,Blake2128Concat:ko,Blake2256:Yt,Blake3256:So,Blake3256Concat:lu,Bytes:Z,Enum:bt,FixedSizeBinary:mn,Hex:Pe,Identity:Io,Option:ct,Result:wn,ScaleEnum:or,Self:sr,Storage:To,Struct:me,Tuple:Re,Twox128:En,Twox256:Co,Twox64Concat:$o,Variant:pe,Vector:ge,_Enum:Js,_void:$,bitSequence:Ys,blockHeader:ho,bool:xc,char:wa,compact:ae,compactBn:gn,compactNumber:_,createCodec:j,createDecoder:ln,decAnyMetadata:dr,enhanceCodec:Ke,enhanceDecoder:Qn,enhanceEncoder:Lt,ethAccount:uo,fixedStr:ka,fromBufferToBase58:Fs,getMultisigAccountId:du,getSs58AddressInfo:nr,h64:at,i128:mc,i16:vc,i256:wc,i32:bc,i64:yc,i8:pc,metadata:yt,selfDecoder:Zs,selfEncoder:Qs,sortMultisigSignatories:Po,str:V,u128:cs,u16:tt,u256:gc,u32:Te,u64:Vt,u8:F,unifyMetadata:Xt,v14:go,v14Lookup:xn,v15:wo,v16:xo});const Qe=_,pu=ge(Re(V,Qe)),D={bool:"boolean",str:"string",num:"number",big:"bigint",bits:"bitseq",void:"void"},vu=pe(Object.fromEntries(Object.values(D).map(e=>[e,$]))),bu=ge(Re(V,pe({inline:sr(()=>yr),lookup:Qe}))),yu=ge(Qe),mu=me({typeRef:Qe,length:ct(Qe)}),gu=ct(Qe),wu=Qe,xu=me({ok:Qe,ko:Qe}),yr=pe({struct:pu,terminal:vu,enum:bu,tuple:yu,array:mu,binary:gu,option:wu,result:xu}),Eu={i256:D.big,i128:D.big,i64:D.big,i32:D.num,i16:D.num,i8:D.num,u256:D.big,u128:D.big,u64:D.big,u32:D.num,u16:D.num,u8:D.num,bool:D.bool,char:D.str,str:D.str},Nt=e=>({type:"terminal",value:{type:e}});function kn(e,t=()=>{}){switch(e.type){case"AccountId20":case"AccountId32":return Nt(D.str);case"array":return e.value.type==="primitive"&&e.value.value==="u8"?{type:"binary",value:e.len}:(t(e.value.id),{type:"array",value:{typeRef:e.value.id,length:e.len}});case"bitSequence":return Nt(D.bits);case"compact":return Nt(e.isBig?D.big:D.num);case"enum":return{type:"enum",value:Object.entries(e.value).map(([n,r])=>r.type!=="lookupEntry"?[n,{type:"inline",value:kn(r,t)}]:(t(r.value.id),[n,{type:"lookup",value:r.value.id}]))};case"struct":{const n=Object.entries(e.value).map(([r,s])=>[r,s.id]);return n.forEach(([,r])=>t(r)),{type:"struct",value:n}}case"tuple":{const n=e.value.map(r=>r.id);return n.forEach(t),{type:"tuple",value:n}}case"option":return t(e.value.id),{type:"option",value:e.value.id};case"primitive":return Nt(Eu[e.value]);case"result":return t(e.value.ok.id),t(e.value.ko.id),{type:"result",value:{ok:e.value.ok.id,ko:e.value.ko.id}};case"sequence":return e.value.type==="primitive"&&e.value.value==="u8"?{type:"binary",value:void 0}:(t(e.value.id),{type:"array",value:{typeRef:e.value.id}});case"void":return Nt(D.void)}}function mr(e,t,n){if(t.type==="option"&&e==null)return!0;const r=(o,i)=>mr(o,i,n),s=o=>{switch(o.value.type){case D.str:case D.big:case D.bool:case D.num:return typeof e===o.value.type;case D.bits:return typeof e=="object"&&e!=null&&typeof e.bitsLen=="number"&&e.bytes instanceof Uint8Array;case D.void:return!0}};switch(t.type){case"terminal":return s(t);case"binary":return e instanceof Fe&&(t.value==null||e.asBytes().length>=t.value);case"array":if(!Array.isArray(e))return!1;const o=e;return t.value.length!=null&&o.length<t.value.length?!1:o.slice(0,t.value.length).every(l=>r(l,n(t.value.typeRef)));case"enum":if(!e)return!1;const i=e,c=Object.fromEntries(t.value);if(!(i.type in c))return!1;const u=c[i.type];return u==null?!0:r(i.value,u.type==="inline"?u.value:n(u.value));case"option":return e==null?!0:r(e,n(t.value));case"struct":return e?t.value.every(([l,h])=>r(e[l],n(h))):!1;case"tuple":return e?t.value.every((l,h)=>r(e[h],n(l))):!1;case"result":return"success"in e&&"value"in e?r(e.value,n(e.success?t.value.ok:t.value.ko)):!1}}var ku=Object.defineProperty,Au=(e,t,n)=>t in e?ku(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Su=(e,t,n)=>Au(e,t+"",n);class Uo{constructor(t=[]){Su(this,"value",new Map),t.forEach(([n,r])=>this.add(n,r))}has(t,n){return this.value.get(t)?.has(n)??!1}add(t,n){this.value.has(t)||this.value.set(t,new Set),this.value.get(t).add(n)}addAll(t){t.forEach(([n,r])=>this.add(n,r))}delete(t,n){if(!this.value.has(t))return;const r=this.value.get(t);r.delete(n),r.size||this.value.delete(t)}isEmpty(){return!this.value.size}get values(){return Array.from(this.value).flatMap(([t,n])=>Array.from(n).map(r=>[t,r]))}}var Be=(e=>(e[e.Incompatible=0]="Incompatible",e[e.Partial=1]="Partial",e[e.BackwardsCompatible=2]="BackwardsCompatible",e[e.Identical=3]="Identical",e))(Be||{});function gr(e,t,n,r,s){if(!n&&!e)return be(3);if(!n)return be(2);if(!e)return be(n.type==="option"?2:0);s.has(n)||s.set(n,new Map);const o=s.get(n);if(o.has(e)){const c=o.get(e);return c===null?{level:3,assumptions:new Uo([[e,n]])}:be(c)}o.set(e,null);const i=Iu(e,n,(c,u)=>gr(typeof c=="number"?t(c):c,t,typeof u=="number"?r(u):u,r,s));return i.assumptions.delete(e,n),i.assumptions.isEmpty()||i.level===0?o.set(e,i.level):o.delete(e),i}function Iu(e,t,n){if(e.type!==t.type)return t.type==="option"?An(n(e,t.value),2):e.type==="option"?An(n(e.value,t),1):be(0);switch(t.type){case"terminal":return be(t.value.type===e.value.type?3:0);case"binary":return be(Lo(e.value,t.value));case"array":const s=e,o=be(Lo(s.value.length,t.value.length));return wr([o,()=>n(s.value.typeRef,t.value.typeRef)]);case"enum":{const h=e,d=Object.fromEntries(t.value.map(([f,p])=>[f,p.value])),a=h.value.length===t.value.length?3:2;return An(Mo(h.value.map(([f,p])=>()=>f in d?n(p.value,d[f]):be(0))),a)}case"option":return n(e.value,t.value);case"struct":const i=e,c=Object.fromEntries(i.value),u=i.value.length===t.value.length?3:2;return An(wr(t.value.map(([h,d])=>()=>n(c[h],d))),u);case"tuple":{const h=e,d=be(_u(h.value,t.value));return wr([d,...t.value.map((a,f)=>()=>n(h.value[f],a))])}case"result":const l=e;return Mo([n(l.value.ok,t.value.ok),n(l.value.ko,t.value.ko)])}}const An=(e,t)=>({...e,level:Math.min(e.level,t)}),Bu=new Uo,be=e=>({level:e,assumptions:Bu}),wr=e=>{let t=be(3);for(const n of e){const r=typeof n=="function"?n():n;if(r.level===0)return r;t.assumptions.addAll(r.assumptions.values),t.level=Math.min(t.level,r.level)}return t},Mo=e=>{if(!e.length)return be(3);let t=!1,n=be(3);for(const r of e){const s=typeof r=="function"?r():r;if(s.level===0){n.level=Math.min(n.level,1);continue}t=!0,n.assumptions.addAll(s.assumptions.values),n.level=Math.min(n.level,s.level)}return t?n:be(0)},_u=(e,t)=>t.length===e.length?3:e.length>=t.length?2:0,Lo=(e,t)=>t===e?3:t==null||e>=t?2:e==null?1:0,Vo=pe({lookup:_,typedef:yr}),It=e=>({type:"lookup",value:e}),xr=e=>({type:"typedef",value:e}),Sn=xr({type:"terminal",value:{type:D.void}}),Cu=me({args:Vo,values:Vo});function $u(e){if(e.type.tag==="plain")return{args:Sn,values:It(e.type.value)};const{key:t,value:n}=e.type.value;return{args:It(t),values:It(n)}}function Do(e){return{args:xr({type:"tuple",value:e.inputs.map(t=>t.type)}),values:It(e.output)}}function Ou(e){return e.type==="lookupEntry"?It(e.value.id):xr(kn(e))}function Tu(e){return{args:Sn,values:It(e)}}function Pu(e,t,n,r,s){const o=(i,c)=>i.type==="lookup"?c(i.value):i.value;return{args:gr(o(e.args,t),t,o(n.args,r),r,s).level,values:gr(o(n.values,r),r,o(e.values,t),t,s).level}}function jo(e,t,n){const r=e.type==="lookup"?t(e.value):e.value;return mr(n,r,t)}var Er=function(e,t){return Er=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(n[s]=r[s])},Er(e,t)};function He(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");Er(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}function Ru(e,t,n,r){function s(o){return o instanceof n?o:new n(function(i){i(o)})}return new(n||(n=Promise))(function(o,i){function c(h){try{l(r.next(h))}catch(d){i(d)}}function u(h){try{l(r.throw(h))}catch(d){i(d)}}function l(h){h.done?o(h.value):s(h.value).then(c,u)}l((r=r.apply(e,t||[])).next())})}function Fo(e,t){var n={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},r,s,o,i=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return i.next=c(0),i.throw=c(1),i.return=c(2),typeof Symbol=="function"&&(i[Symbol.iterator]=function(){return this}),i;function c(l){return function(h){return u([l,h])}}function u(l){if(r)throw new TypeError("Generator is already executing.");for(;i&&(i=0,l[0]&&(n=0)),n;)try{if(r=1,s&&(o=l[0]&2?s.return:l[0]?s.throw||((o=s.return)&&o.call(s),0):s.next)&&!(o=o.call(s,l[1])).done)return o;switch(s=0,o&&(l=[l[0]&2,o.value]),l[0]){case 0:case 1:o=l;break;case 4:return n.label++,{value:l[1],done:!1};case 5:n.label++,s=l[1],l=[0];continue;case 7:l=n.ops.pop(),n.trys.pop();continue;default:if(o=n.trys,!(o=o.length>0&&o[o.length-1])&&(l[0]===6||l[0]===2)){n=0;continue}if(l[0]===3&&(!o||l[1]>o[0]&&l[1]<o[3])){n.label=l[1];break}if(l[0]===6&&n.label<o[1]){n.label=o[1],o=l;break}if(o&&n.label<o[2]){n.label=o[2],n.ops.push(l);break}o[2]&&n.ops.pop(),n.trys.pop();continue}l=t.call(e,n)}catch(h){l=[6,h],s=0}finally{r=o=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}}function Bt(e){var t=typeof Symbol=="function"&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function Ue(e,t){var n=typeof Symbol=="function"&&e[Symbol.iterator];if(!n)return e;var r=n.call(e),s,o=[],i;try{for(;(t===void 0||t-- >0)&&!(s=r.next()).done;)o.push(s.value)}catch(c){i={error:c}}finally{try{s&&!s.done&&(n=r.return)&&n.call(r)}finally{if(i)throw i.error}}return o}function Me(e,t,n){if(n||arguments.length===2)for(var r=0,s=t.length,o;r<s;r++)(o||!(r in t))&&(o||(o=Array.prototype.slice.call(t,0,r)),o[r]=t[r]);return e.concat(o||Array.prototype.slice.call(t))}function _t(e){return this instanceof _t?(this.v=e,this):new _t(e)}function Uu(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=n.apply(e,t||[]),s,o=[];return s=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),c("next"),c("throw"),c("return",i),s[Symbol.asyncIterator]=function(){return this},s;function i(f){return function(p){return Promise.resolve(p).then(f,d)}}function c(f,p){r[f]&&(s[f]=function(v){return new Promise(function(b,y){o.push([f,v,b,y])>1||u(f,v)})},p&&(s[f]=p(s[f])))}function u(f,p){try{l(r[f](p))}catch(v){a(o[0][3],v)}}function l(f){f.value instanceof _t?Promise.resolve(f.value.v).then(h,d):a(o[0][2],f)}function h(f){u("next",f)}function d(f){u("throw",f)}function a(f,p){f(p),o.shift(),o.length&&u(o[0][0],o[0][1])}}function Mu(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=e[Symbol.asyncIterator],n;return t?t.call(e):(e=typeof Bt=="function"?Bt(e):e[Symbol.iterator](),n={},r("next"),r("throw"),r("return"),n[Symbol.asyncIterator]=function(){return this},n);function r(o){n[o]=e[o]&&function(i){return new Promise(function(c,u){i=e[o](i),s(c,u,i.done,i.value)})}}function s(o,i,c,u){Promise.resolve(u).then(function(l){o({value:l,done:c})},i)}}typeof SuppressedError=="function"&&SuppressedError;function z(e){return typeof e=="function"}function kr(e){var t=function(r){Error.call(r),r.stack=new Error().stack},n=e(t);return n.prototype=Object.create(Error.prototype),n.prototype.constructor=n,n}var Ar=kr(function(e){return function(n){e(this),this.message=n?n.length+` errors occurred during unsubscription:
`+n.map(function(r,s){return s+1+") "+r.toString()}).join(`
  `):"",this.name="UnsubscriptionError",this.errors=n}});function In(e,t){if(e){var n=e.indexOf(t);0<=n&&e.splice(n,1)}}var gt=function(){function e(t){this.initialTeardown=t,this.closed=!1,this._parentage=null,this._finalizers=null}return e.prototype.unsubscribe=function(){var t,n,r,s,o;if(!this.closed){this.closed=!0;var i=this._parentage;if(i)if(this._parentage=null,Array.isArray(i))try{for(var c=Bt(i),u=c.next();!u.done;u=c.next()){var l=u.value;l.remove(this)}}catch(v){t={error:v}}finally{try{u&&!u.done&&(n=c.return)&&n.call(c)}finally{if(t)throw t.error}}else i.remove(this);var h=this.initialTeardown;if(z(h))try{h()}catch(v){o=v instanceof Ar?v.errors:[v]}var d=this._finalizers;if(d){this._finalizers=null;try{for(var a=Bt(d),f=a.next();!f.done;f=a.next()){var p=f.value;try{qo(p)}catch(v){o=o??[],v instanceof Ar?o=Me(Me([],Ue(o)),Ue(v.errors)):o.push(v)}}}catch(v){r={error:v}}finally{try{f&&!f.done&&(s=a.return)&&s.call(a)}finally{if(r)throw r.error}}}if(o)throw new Ar(o)}},e.prototype.add=function(t){var n;if(t&&t!==this)if(this.closed)qo(t);else{if(t instanceof e){if(t.closed||t._hasParent(this))return;t._addParent(this)}(this._finalizers=(n=this._finalizers)!==null&&n!==void 0?n:[]).push(t)}},e.prototype._hasParent=function(t){var n=this._parentage;return n===t||Array.isArray(n)&&n.includes(t)},e.prototype._addParent=function(t){var n=this._parentage;this._parentage=Array.isArray(n)?(n.push(t),n):n?[n,t]:t},e.prototype._removeParent=function(t){var n=this._parentage;n===t?this._parentage=null:Array.isArray(n)&&In(n,t)},e.prototype.remove=function(t){var n=this._finalizers;n&&In(n,t),t instanceof e&&t._removeParent(this)},e.EMPTY=function(){var t=new e;return t.closed=!0,t}(),e}(),zo=gt.EMPTY;function Ho(e){return e instanceof gt||e&&"closed"in e&&z(e.remove)&&z(e.add)&&z(e.unsubscribe)}function qo(e){z(e)?e():e.unsubscribe()}var Lu={Promise:void 0},Vu={setTimeout:function(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];return setTimeout.apply(void 0,Me([e,t],Ue(n)))},clearTimeout:function(e){return clearTimeout(e)},delegate:void 0};function Wo(e){Vu.setTimeout(function(){throw e})}function _e(){}function Bn(e){e()}var Qt=function(e){He(t,e);function t(n){var r=e.call(this)||this;return r.isStopped=!1,n?(r.destination=n,Ho(n)&&n.add(r)):r.destination=Fu,r}return t.create=function(n,r,s){return new Ct(n,r,s)},t.prototype.next=function(n){this.isStopped||this._next(n)},t.prototype.error=function(n){this.isStopped||(this.isStopped=!0,this._error(n))},t.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},t.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,e.prototype.unsubscribe.call(this),this.destination=null)},t.prototype._next=function(n){this.destination.next(n)},t.prototype._error=function(n){try{this.destination.error(n)}finally{this.unsubscribe()}},t.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},t}(gt),Du=function(){function e(t){this.partialObserver=t}return e.prototype.next=function(t){var n=this.partialObserver;if(n.next)try{n.next(t)}catch(r){_n(r)}},e.prototype.error=function(t){var n=this.partialObserver;if(n.error)try{n.error(t)}catch(r){_n(r)}else _n(t)},e.prototype.complete=function(){var t=this.partialObserver;if(t.complete)try{t.complete()}catch(n){_n(n)}},e}(),Ct=function(e){He(t,e);function t(n,r,s){var o=e.call(this)||this,i;return z(n)||!n?i={next:n??void 0,error:r??void 0,complete:s??void 0}:i=n,o.destination=new Du(i),o}return t}(Qt);function _n(e){Wo(e)}function ju(e){throw e}var Fu={closed:!0,next:_e,error:ju,complete:_e},Sr=function(){return typeof Symbol=="function"&&Symbol.observable||"@@observable"}();function Ze(e){return e}function Ko(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return Xo(e)}function Xo(e){return e.length===0?Ze:e.length===1?e[0]:function(n){return e.reduce(function(r,s){return s(r)},n)}}var T=function(){function e(t){t&&(this._subscribe=t)}return e.prototype.lift=function(t){var n=new e;return n.source=this,n.operator=t,n},e.prototype.subscribe=function(t,n,r){var s=this,o=Hu(t)?t:new Ct(t,n,r);return Bn(function(){var i=s,c=i.operator,u=i.source;o.add(c?c.call(o,u):u?s._subscribe(o):s._trySubscribe(o))}),o},e.prototype._trySubscribe=function(t){try{return this._subscribe(t)}catch(n){t.error(n)}},e.prototype.forEach=function(t,n){var r=this;return n=Yo(n),new n(function(s,o){var i=new Ct({next:function(c){try{t(c)}catch(u){o(u),i.unsubscribe()}},error:o,complete:s});r.subscribe(i)})},e.prototype._subscribe=function(t){var n;return(n=this.source)===null||n===void 0?void 0:n.subscribe(t)},e.prototype[Sr]=function(){return this},e.prototype.pipe=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return Xo(t)(this)},e.prototype.toPromise=function(t){var n=this;return t=Yo(t),new t(function(r,s){var o;n.subscribe(function(i){return o=i},function(i){return s(i)},function(){return r(o)})})},e.create=function(t){return new e(t)},e}();function Yo(e){var t;return(t=e??Lu.Promise)!==null&&t!==void 0?t:Promise}function zu(e){return e&&z(e.next)&&z(e.error)&&z(e.complete)}function Hu(e){return e&&e instanceof Qt||zu(e)&&Ho(e)}function qu(e){return z(e?.lift)}function N(e){return function(t){if(qu(t))return t.lift(function(n){try{return e(n,this)}catch(r){this.error(r)}});throw new TypeError("Unable to lift unknown Observable type")}}function q(e,t,n,r,s){return new Wu(e,t,n,r,s)}var Wu=function(e){He(t,e);function t(n,r,s,o,i,c){var u=e.call(this,n)||this;return u.onFinalize=i,u.shouldUnsubscribe=c,u._next=r?function(l){try{r(l)}catch(h){n.error(h)}}:e.prototype._next,u._error=o?function(l){try{o(l)}catch(h){n.error(h)}finally{this.unsubscribe()}}:e.prototype._error,u._complete=s?function(){try{s()}catch(l){n.error(l)}finally{this.unsubscribe()}}:e.prototype._complete,u}return t.prototype.unsubscribe=function(){var n;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){var r=this.closed;e.prototype.unsubscribe.call(this),!r&&((n=this.onFinalize)===null||n===void 0||n.call(this))}},t}(Qt),Ku=kr(function(e){return function(){e(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"}}),Le=function(e){He(t,e);function t(){var n=e.call(this)||this;return n.closed=!1,n.currentObservers=null,n.observers=[],n.isStopped=!1,n.hasError=!1,n.thrownError=null,n}return t.prototype.lift=function(n){var r=new Go(this,this);return r.operator=n,r},t.prototype._throwIfClosed=function(){if(this.closed)throw new Ku},t.prototype.next=function(n){var r=this;Bn(function(){var s,o;if(r._throwIfClosed(),!r.isStopped){r.currentObservers||(r.currentObservers=Array.from(r.observers));try{for(var i=Bt(r.currentObservers),c=i.next();!c.done;c=i.next()){var u=c.value;u.next(n)}}catch(l){s={error:l}}finally{try{c&&!c.done&&(o=i.return)&&o.call(i)}finally{if(s)throw s.error}}}})},t.prototype.error=function(n){var r=this;Bn(function(){if(r._throwIfClosed(),!r.isStopped){r.hasError=r.isStopped=!0,r.thrownError=n;for(var s=r.observers;s.length;)s.shift().error(n)}})},t.prototype.complete=function(){var n=this;Bn(function(){if(n._throwIfClosed(),!n.isStopped){n.isStopped=!0;for(var r=n.observers;r.length;)r.shift().complete()}})},t.prototype.unsubscribe=function(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null},Object.defineProperty(t.prototype,"observed",{get:function(){var n;return((n=this.observers)===null||n===void 0?void 0:n.length)>0},enumerable:!1,configurable:!0}),t.prototype._trySubscribe=function(n){return this._throwIfClosed(),e.prototype._trySubscribe.call(this,n)},t.prototype._subscribe=function(n){return this._throwIfClosed(),this._checkFinalizedStatuses(n),this._innerSubscribe(n)},t.prototype._innerSubscribe=function(n){var r=this,s=this,o=s.hasError,i=s.isStopped,c=s.observers;return o||i?zo:(this.currentObservers=null,c.push(n),new gt(function(){r.currentObservers=null,In(c,n)}))},t.prototype._checkFinalizedStatuses=function(n){var r=this,s=r.hasError,o=r.thrownError,i=r.isStopped;s?n.error(o):i&&n.complete()},t.prototype.asObservable=function(){var n=new T;return n.source=this,n},t.create=function(n,r){return new Go(n,r)},t}(T),Go=function(e){He(t,e);function t(n,r){var s=e.call(this)||this;return s.destination=n,s.source=r,s}return t.prototype.next=function(n){var r,s;(s=(r=this.destination)===null||r===void 0?void 0:r.next)===null||s===void 0||s.call(r,n)},t.prototype.error=function(n){var r,s;(s=(r=this.destination)===null||r===void 0?void 0:r.error)===null||s===void 0||s.call(r,n)},t.prototype.complete=function(){var n,r;(r=(n=this.destination)===null||n===void 0?void 0:n.complete)===null||r===void 0||r.call(n)},t.prototype._subscribe=function(n){var r,s;return(s=(r=this.source)===null||r===void 0?void 0:r.subscribe(n))!==null&&s!==void 0?s:zo},t}(Le),Xu=function(e){He(t,e);function t(n){var r=e.call(this)||this;return r._value=n,r}return Object.defineProperty(t.prototype,"value",{get:function(){return this.getValue()},enumerable:!1,configurable:!0}),t.prototype._subscribe=function(n){var r=e.prototype._subscribe.call(this,n);return!r.closed&&n.next(this._value),r},t.prototype.getValue=function(){var n=this,r=n.hasError,s=n.thrownError,o=n._value;if(r)throw s;return this._throwIfClosed(),o},t.prototype.next=function(n){e.prototype.next.call(this,this._value=n)},t}(Le),Ir={now:function(){return(Ir.delegate||Date).now()},delegate:void 0},Cn=function(e){He(t,e);function t(n,r,s){n===void 0&&(n=1/0),r===void 0&&(r=1/0),s===void 0&&(s=Ir);var o=e.call(this)||this;return o._bufferSize=n,o._windowTime=r,o._timestampProvider=s,o._buffer=[],o._infiniteTimeWindow=!0,o._infiniteTimeWindow=r===1/0,o._bufferSize=Math.max(1,n),o._windowTime=Math.max(1,r),o}return t.prototype.next=function(n){var r=this,s=r.isStopped,o=r._buffer,i=r._infiniteTimeWindow,c=r._timestampProvider,u=r._windowTime;s||(o.push(n),!i&&o.push(c.now()+u)),this._trimBuffer(),e.prototype.next.call(this,n)},t.prototype._subscribe=function(n){this._throwIfClosed(),this._trimBuffer();for(var r=this._innerSubscribe(n),s=this,o=s._infiniteTimeWindow,i=s._buffer,c=i.slice(),u=0;u<c.length&&!n.closed;u+=o?1:2)n.next(c[u]);return this._checkFinalizedStatuses(n),r},t.prototype._trimBuffer=function(){var n=this,r=n._bufferSize,s=n._timestampProvider,o=n._buffer,i=n._infiniteTimeWindow,c=(i?1:2)*r;if(r<1/0&&c<o.length&&o.splice(0,o.length-c),!i){for(var u=s.now(),l=0,h=1;h<o.length&&o[h]<=u;h+=2)l=h;l&&o.splice(0,l+1)}},t}(Le),Yu=function(e){He(t,e);function t(n,r){return e.call(this)||this}return t.prototype.schedule=function(n,r){return this},t}(gt),No={setInterval:function(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];return setInterval.apply(void 0,Me([e,t],Ue(n)))},clearInterval:function(e){return clearInterval(e)},delegate:void 0},Gu=function(e){He(t,e);function t(n,r){var s=e.call(this,n,r)||this;return s.scheduler=n,s.work=r,s.pending=!1,s}return t.prototype.schedule=function(n,r){var s;if(r===void 0&&(r=0),this.closed)return this;this.state=n;var o=this.id,i=this.scheduler;return o!=null&&(this.id=this.recycleAsyncId(i,o,r)),this.pending=!0,this.delay=r,this.id=(s=this.id)!==null&&s!==void 0?s:this.requestAsyncId(i,this.id,r),this},t.prototype.requestAsyncId=function(n,r,s){return s===void 0&&(s=0),No.setInterval(n.flush.bind(n,this),s)},t.prototype.recycleAsyncId=function(n,r,s){if(s===void 0&&(s=0),s!=null&&this.delay===s&&this.pending===!1)return r;r!=null&&No.clearInterval(r)},t.prototype.execute=function(n,r){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;var s=this._execute(n,r);if(s)return s;this.pending===!1&&this.id!=null&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))},t.prototype._execute=function(n,r){var s=!1,o;try{this.work(n)}catch(i){s=!0,o=i||new Error("Scheduled action threw falsy error")}if(s)return this.unsubscribe(),o},t.prototype.unsubscribe=function(){if(!this.closed){var n=this,r=n.id,s=n.scheduler,o=s.actions;this.work=this.state=this.scheduler=null,this.pending=!1,In(o,this),r!=null&&(this.id=this.recycleAsyncId(s,r,null)),this.delay=null,e.prototype.unsubscribe.call(this)}},t}(Yu),Qo=function(){function e(t,n){n===void 0&&(n=e.now),this.schedulerActionCtor=t,this.now=n}return e.prototype.schedule=function(t,n,r){return n===void 0&&(n=0),new this.schedulerActionCtor(this,t).schedule(r,n)},e.now=Ir.now,e}(),Nu=function(e){He(t,e);function t(n,r){r===void 0&&(r=Qo.now);var s=e.call(this,n,r)||this;return s.actions=[],s._active=!1,s}return t.prototype.flush=function(n){var r=this.actions;if(this._active){r.push(n);return}var s;this._active=!0;do if(s=n.execute(n.state,n.delay))break;while(n=r.shift());if(this._active=!1,s){for(;n=r.shift();)n.unsubscribe();throw s}},t}(Qo),Zo=new Nu(Gu),Qu=Zo,wt=new T(function(e){return e.complete()});function Jo(e){return e&&z(e.schedule)}function Br(e){return e[e.length-1]}function _r(e){return z(Br(e))?e.pop():void 0}function Zt(e){return Jo(Br(e))?e.pop():void 0}function Zu(e,t){return typeof Br(e)=="number"?e.pop():t}var ei=function(e){return e&&typeof e.length=="number"&&typeof e!="function"};function ti(e){return z(e?.then)}function ni(e){return z(e[Sr])}function ri(e){return Symbol.asyncIterator&&z(e?.[Symbol.asyncIterator])}function si(e){return new TypeError("You provided "+(e!==null&&typeof e=="object"?"an invalid object":"'"+e+"'")+" where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.")}function Ju(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var oi=Ju();function ii(e){return z(e?.[oi])}function ci(e){return Uu(this,arguments,function(){var n,r,s,o;return Fo(this,function(i){switch(i.label){case 0:n=e.getReader(),i.label=1;case 1:i.trys.push([1,,9,10]),i.label=2;case 2:return[4,_t(n.read())];case 3:return r=i.sent(),s=r.value,o=r.done,o?[4,_t(void 0)]:[3,5];case 4:return[2,i.sent()];case 5:return[4,_t(s)];case 6:return[4,i.sent()];case 7:return i.sent(),[3,2];case 8:return[3,10];case 9:return n.releaseLock(),[7];case 10:return[2]}})})}function ai(e){return z(e?.getReader)}function oe(e){if(e instanceof T)return e;if(e!=null){if(ni(e))return el(e);if(ei(e))return tl(e);if(ti(e))return nl(e);if(ri(e))return ui(e);if(ii(e))return rl(e);if(ai(e))return sl(e)}throw si(e)}function el(e){return new T(function(t){var n=e[Sr]();if(z(n.subscribe))return n.subscribe(t);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}function tl(e){return new T(function(t){for(var n=0;n<e.length&&!t.closed;n++)t.next(e[n]);t.complete()})}function nl(e){return new T(function(t){e.then(function(n){t.closed||(t.next(n),t.complete())},function(n){return t.error(n)}).then(null,Wo)})}function rl(e){return new T(function(t){var n,r;try{for(var s=Bt(e),o=s.next();!o.done;o=s.next()){var i=o.value;if(t.next(i),t.closed)return}}catch(c){n={error:c}}finally{try{o&&!o.done&&(r=s.return)&&r.call(s)}finally{if(n)throw n.error}}t.complete()})}function ui(e){return new T(function(t){ol(e,t).catch(function(n){return t.error(n)})})}function sl(e){return ui(ci(e))}function ol(e,t){var n,r,s,o;return Ru(this,void 0,void 0,function(){var i,c;return Fo(this,function(u){switch(u.label){case 0:u.trys.push([0,5,6,11]),n=Mu(e),u.label=1;case 1:return[4,n.next()];case 2:if(r=u.sent(),!!r.done)return[3,4];if(i=r.value,t.next(i),t.closed)return[2];u.label=3;case 3:return[3,1];case 4:return[3,11];case 5:return c=u.sent(),s={error:c},[3,11];case 6:return u.trys.push([6,,9,10]),r&&!r.done&&(o=n.return)?[4,o.call(n)]:[3,8];case 7:u.sent(),u.label=8;case 8:return[3,10];case 9:if(s)throw s.error;return[7];case 10:return[7];case 11:return t.complete(),[2]}})})}function ut(e,t,n,r,s){r===void 0&&(r=0),s===void 0&&(s=!1);var o=t.schedule(function(){n(),s?e.add(this.schedule(null,r)):this.unsubscribe()},r);if(e.add(o),!s)return o}function li(e,t){return t===void 0&&(t=0),N(function(n,r){n.subscribe(q(r,function(s){return ut(r,e,function(){return r.next(s)},t)},function(){return ut(r,e,function(){return r.complete()},t)},function(s){return ut(r,e,function(){return r.error(s)},t)}))})}function fi(e,t){return t===void 0&&(t=0),N(function(n,r){r.add(e.schedule(function(){return n.subscribe(r)},t))})}function il(e,t){return oe(e).pipe(fi(t),li(t))}function cl(e,t){return oe(e).pipe(fi(t),li(t))}function al(e,t){return new T(function(n){var r=0;return t.schedule(function(){r===e.length?n.complete():(n.next(e[r++]),n.closed||this.schedule())})})}function ul(e,t){return new T(function(n){var r;return ut(n,t,function(){r=e[oi](),ut(n,t,function(){var s,o,i;try{s=r.next(),o=s.value,i=s.done}catch(c){n.error(c);return}i?n.complete():n.next(o)},0,!0)}),function(){return z(r?.return)&&r.return()}})}function hi(e,t){if(!e)throw new Error("Iterable cannot be null");return new T(function(n){ut(n,t,function(){var r=e[Symbol.asyncIterator]();ut(n,t,function(){r.next().then(function(s){s.done?n.complete():n.next(s.value)})},0,!0)})})}function ll(e,t){return hi(ci(e),t)}function fl(e,t){if(e!=null){if(ni(e))return il(e,t);if(ei(e))return al(e,t);if(ti(e))return cl(e,t);if(ri(e))return hi(e,t);if(ii(e))return ul(e,t);if(ai(e))return ll(e,t)}throw si(e)}function xt(e,t){return t?fl(e,t):oe(e)}function Ee(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=Zt(e);return xt(e,n)}function $n(e,t){var n=z(e)?e:function(){return e},r=function(s){return s.error(n())};return new T(r)}var di=kr(function(e){return function(){e(this),this.name="EmptyError",this.message="no elements in sequence"}});function hl(e,t){return new Promise(function(n,r){var s=!1,o;e.subscribe({next:function(i){o=i,s=!0},error:r,complete:function(){s?n(o):r(new di)}})})}function Ve(e,t){return new Promise(function(n,r){var s=new Ct({next:function(o){n(o),s.unsubscribe()},error:r,complete:function(){r(new di)}});e.subscribe(s)})}function dl(e){return e instanceof Date&&!isNaN(e)}function S(e,t){return N(function(n,r){var s=0;n.subscribe(q(r,function(o){r.next(e.call(t,o,s++))}))})}var pl=Array.isArray;function vl(e,t){return pl(t)?e.apply(void 0,Me([],Ue(t))):e(t)}function pi(e){return S(function(t){return vl(e,t)})}var bl=Array.isArray,yl=Object.getPrototypeOf,ml=Object.prototype,gl=Object.keys;function wl(e){if(e.length===1){var t=e[0];if(bl(t))return{args:t,keys:null};if(xl(t)){var n=gl(t);return{args:n.map(function(r){return t[r]}),keys:n}}}return{args:e,keys:null}}function xl(e){return e&&typeof e=="object"&&yl(e)===ml}function El(e,t){return e.reduce(function(n,r,s){return n[r]=t[s],n},{})}function $t(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=Zt(e),r=_r(e),s=wl(e),o=s.args,i=s.keys;if(o.length===0)return xt([],n);var c=new T(vi(o,n,i?function(u){return El(i,u)}:Ze));return r?c.pipe(pi(r)):c}function vi(e,t,n){return n===void 0&&(n=Ze),function(r){bi(t,function(){for(var s=e.length,o=new Array(s),i=s,c=s,u=function(h){bi(t,function(){var d=xt(e[h],t),a=!1;d.subscribe(q(r,function(f){o[h]=f,a||(a=!0,c--),c||r.next(n(o.slice()))},function(){--i||r.complete()}))},r)},l=0;l<s;l++)u(l)},r)}}function bi(e,t,n){e?ut(n,e,t):t()}function kl(e,t,n,r,s,o,i,c){var u=[],l=0,h=0,d=!1,a=function(){d&&!u.length&&!l&&t.complete()},f=function(v){return l<r?p(v):u.push(v)},p=function(v){l++;var b=!1;oe(n(v,h++)).subscribe(q(t,function(y){t.next(y)},function(){b=!0},void 0,function(){if(b)try{l--;for(var y=function(){var g=u.shift();i||p(g)};u.length&&l<r;)y();a()}catch(g){t.error(g)}}))};return e.subscribe(q(t,f,function(){d=!0,a()})),function(){}}function U(e,t,n){return n===void 0&&(n=1/0),z(t)?U(function(r,s){return S(function(o,i){return t(r,o,s,i)})(oe(e(r,s)))},n):(typeof t=="number"&&(n=t),N(function(r,s){return kl(r,s,e,n)}))}function On(e){return e===void 0&&(e=1/0),U(Ze,e)}function Al(){return On(1)}function Cr(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return Al()(xt(e,Zt(e)))}function Tn(e){return new T(function(t){oe(e()).subscribe(t)})}var Sl={connector:function(){return new Le},resetOnDisconnect:!0};function Il(e,t){t===void 0&&(t=Sl);var n=null,r=t.connector,s=t.resetOnDisconnect,o=s===void 0?!0:s,i=r(),c=new T(function(u){return i.subscribe(u)});return c.connect=function(){return(!n||n.closed)&&(n=Tn(function(){return e}).subscribe(i),o&&n.add(function(){return i=r()})),n},c}function Pn(e,t,n){e===void 0&&(e=0),n===void 0&&(n=Qu);var r=-1;return t!=null&&(Jo(t)?n=t:r=t),new T(function(s){var o=dl(e)?+e-n.now():e;o<0&&(o=0);var i=0;return n.schedule(function(){s.closed||(s.next(i++),0<=r?this.schedule(void 0,r):s.complete())},o)})}function $r(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=Zt(e),r=Zu(e,1/0),s=e;return s.length?s.length===1?oe(s[0]):On(r)(xt(s,n)):wt}var Bl=Array.isArray;function _l(e){return e.length===1&&Bl(e[0])?e[0]:e}function Ce(e,t){return N(function(n,r){var s=0;n.subscribe(q(r,function(o){return e.call(t,o,s++)&&r.next(o)}))})}function Je(e){return N(function(t,n){var r=null,s=!1,o;r=t.subscribe(q(n,void 0,void 0,function(i){o=oe(e(i,Je(e)(t))),r?(r.unsubscribe(),r=null,o.subscribe(n)):s=!0})),s&&(r.unsubscribe(),r=null,o.subscribe(n))})}function Cl(e,t,n,r,s){return function(o,i){var c=n,u=t,l=0;o.subscribe(q(i,function(h){var d=l++;u=c?e(u,h,d):(c=!0,h),i.next(u)},s))}}function yi(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=_r(e);return n?Ko(yi.apply(void 0,Me([],Ue(e))),pi(n)):N(function(r,s){vi(Me([r],Ue(_l(e))))(s)})}function $l(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return yi.apply(void 0,Me([],Ue(e)))}function Ol(e,t){return z(t)?U(e,t,1):U(e,1)}function ne(e){return e<=0?function(){return wt}:N(function(t,n){var r=0;t.subscribe(q(n,function(s){++r<=e&&(n.next(s),e<=r&&n.complete())}))})}function Tl(e){return S(function(){return e})}function Pl(e,t){return U(function(n,r){return oe(e(n,r)).pipe(ne(1),Tl(n))})}function Rl(e,t){t===void 0&&(t=Zo);var n=Pn(e,t);return Pl(function(){return n})}function Ul(e,t){return N(function(n,r){var s=new Set;n.subscribe(q(r,function(o){var i=e?e(o):o;s.has(i)||(s.add(i),r.next(o))})),t&&oe(t).subscribe(q(r,function(){return s.clear()},_e))})}function fe(e,t){return t===void 0&&(t=Ze),e=e??Ml,N(function(n,r){var s,o=!0;n.subscribe(q(r,function(i){var c=t(i);(o||!e(s,c))&&(o=!1,s=c,r.next(i))}))})}function Ml(e,t){return e===t}function Ll(e,t){return N(function(n,r){var s=0,o=null,i=!1;n.subscribe(q(r,function(c){o||(o=q(r,void 0,function(){o=null,i&&r.complete()}),oe(e(c,s++)).subscribe(o))},function(){i=!0,!o&&r.complete()}))})}function Vl(){return N(function(e,t){var n,r=!1;e.subscribe(q(t,function(s){var o=n;n=s,r&&t.next([o,s]),r=!0}))})}function Jt(e,t){return N(Cl(e,t,arguments.length>=2,!0))}function en(e){e===void 0&&(e={});var t=e.connector,n=t===void 0?function(){return new Le}:t,r=e.resetOnError,s=r===void 0?!0:r,o=e.resetOnComplete,i=o===void 0?!0:o,c=e.resetOnRefCountZero,u=c===void 0?!0:c;return function(l){var h,d,a,f=0,p=!1,v=!1,b=function(){d?.unsubscribe(),d=void 0},y=function(){b(),h=a=void 0,p=v=!1},g=function(){var w=h;y(),w?.unsubscribe()};return N(function(w,m){f++,!v&&!p&&b();var x=a=a??n();m.add(function(){f--,f===0&&!v&&!p&&(d=Or(g,u))}),x.subscribe(m),!h&&f>0&&(h=new Ct({next:function(k){return x.next(k)},error:function(k){v=!0,b(),d=Or(y,s,k),x.error(k)},complete:function(){p=!0,b(),d=Or(y,i),x.complete()}}),oe(w).subscribe(h))})(l)}}function Or(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(t===!0){e();return}if(t!==!1){var s=new Ct({next:function(){s.unsubscribe(),e()}});return oe(t.apply(void 0,Me([],Ue(n)))).subscribe(s)}}function Rn(e,t,n){var r,s,o,i,c=!1;return e&&typeof e=="object"?(r=e.bufferSize,i=r===void 0?1/0:r,s=e.windowTime,t=s===void 0?1/0:s,o=e.refCount,c=o===void 0?!1:o,n=e.scheduler):i=e??1/0,en({connector:function(){return new Cn(i,t,n)},resetOnError:!0,resetOnComplete:!1,resetOnRefCountZero:c})}function mi(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=Zt(e);return N(function(r,s){(n?Cr(e,r,n):Cr(e,r)).subscribe(s)})}function Un(e,t){return N(function(n,r){var s=null,o=0,i=!1,c=function(){return i&&!s&&r.complete()};n.subscribe(q(r,function(u){s?.unsubscribe();var l=0,h=o++;oe(e(u,h)).subscribe(s=q(r,function(d){return r.next(t?t(u,d,h,l++):d)},function(){s=null,c()}))},function(){i=!0,c()}))})}function Dl(){return Un(Ze)}function gi(e){return N(function(t,n){oe(e).subscribe(q(n,function(){return n.complete()},_e)),!n.closed&&t.subscribe(n)})}function wi(e,t){return t===void 0&&(t=!1),N(function(n,r){var s=0;n.subscribe(q(r,function(o){var i=e(o,s++);(i||t)&&r.next(o),!i&&r.complete()}))})}function Tr(e,t,n){var r=z(e)||t||n?{next:e,error:t,complete:n}:e;return r?N(function(s,o){var i;(i=r.subscribe)===null||i===void 0||i.call(r);var c=!0;s.subscribe(q(o,function(u){var l;(l=r.next)===null||l===void 0||l.call(r,u),o.next(u)},function(){var u;c=!1,(u=r.complete)===null||u===void 0||u.call(r),o.complete()},function(u){var l;c=!1,(l=r.error)===null||l===void 0||l.call(r,u),o.error(u)},function(){var u,l;c&&((u=r.unsubscribe)===null||u===void 0||u.call(r)),(l=r.finalize)===null||l===void 0||l.call(r)}))}):Ze}function Pr(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=_r(e);return N(function(r,s){for(var o=e.length,i=new Array(o),c=e.map(function(){return!1}),u=!1,l=function(d){oe(e[d]).subscribe(q(s,function(a){i[d]=a,!u&&!c[d]&&(c[d]=!0,(u=c.every(Ze))&&(c=null))},_e))},h=0;h<o;h++)l(h);r.subscribe(q(s,function(d){if(u){var a=Me([d],Ue(i));s.next(n?n.apply(void 0,Me([],Ue(a))):a)}}))})}const Ot=()=>{},$e={body:"",call:"",continue:"",follow:"",header:"",stopOperation:"",storage:"",unfollow:"",unpin:"",followEvent:""},Mn={chainName:"",genesisHash:"",properties:""},Rr={broadcast:"",stop:""};Object.entries({chainHead:$e,chainSpec:Mn,transaction:Rr}).forEach(([e,t])=>{Object.keys(t).forEach(n=>{t[n]=`${e}_v1_${n}`})});const jl=e=>(t,n)=>{let r=e(Rr.broadcast,[t],{onSuccess:s=>{r=s===null?Ot:()=>{e(Rr.stop,[s])},s===null&&n(new Error("Max # of broadcasted transactions has been reached"))},onError:n});return()=>{r()}};class xi extends Error{constructor(){super("ChainHead stopped"),this.name="StopError"}}class Ln extends Error{constructor(){super("ChainHead disjointed"),this.name="DisjointError"}}class Vn extends Error{constructor(){super("ChainHead operations limit reached"),this.name="OperationLimitError"}}class Ei extends Error{constructor(t){super(t),this.name="OperationError"}}class Dn extends Error{constructor(){super("ChainHead operation inaccessible"),this.name="OperationInaccessibleError"}}function Fl(){let e=()=>{},t=()=>{};return{promise:new Promise((r,s)=>{e=r,t=s}),res:e,rej:t}}const ki=()=>{const e=new Map;return{has:e.has.bind(e),subscribe(t,n){e.set(t,n)},unsubscribe(t){e.delete(t)},next(t,n){e.get(t)?.next(n)},error(t,n){const r=e.get(t);r&&(e.delete(t),r.error(n))},errorAll(t){const n=[...e.values()];e.clear(),n.forEach(r=>{r.error(t)})}}},jn=e=>(...t)=>new Promise((n,r)=>{let s=Ft;const[o,i]=t[t.length-1]instanceof AbortSignal?[t.slice(0,t.length-1),t[t.length-1]]:[t],c=()=>{s(),r(new Hs)};i?.addEventListener("abort",c,{once:!0});const u=l=>h=>{s=Ft,i?.removeEventListener("abort",c),l(h)};s=e(u(n),u(r),...o)}),Ai=(e,t)=>n=>jn((r,s,...o)=>{let i=!0,c=()=>{i=!1};const[u,l]=t(...o);return n(e,u,{onSuccess:(h,d)=>{if(h.result==="limitReached")return s(new Vn);const{operationId:a}=h,f=()=>{n($e.stopOperation,[a])};if(!i)return f();let p=Ot;const v=y=>{i=!1,p(),r(y)},b=y=>{i=!1,p(),s(y)};p=d(a,{next:y=>{const g=y;g.event==="operationError"?s(new Ei(g.error)):g.event==="operationInaccessible"?s(new Dn):l(y,v,b)},error:b}),c=()=>{i&&(p(),f())}},onError:s}),()=>{c()}}),zl=Ai($e.body,e=>[[e],(t,n)=>{n(t.value)}]),Hl=Ai($e.call,(e,t,n)=>[[e,t,n],(r,s)=>{s(r.output)}]),ql=e=>t=>new Promise((n,r)=>{e($e.header,[t],{onSuccess:n,onError:r})}),Si=e=>(t,n,r,s,o,i,c)=>{if(n.length===0)return i(),Ft;let u=!0,l=()=>{u=!1};return e($e.storage,[t,n,r],{onSuccess:(h,d)=>{if(h.result==="limitReached"||h.discardedItems===n.length)return o(new Vn);const{operationId:a}=h,f=()=>{e($e.stopOperation,[a])};if(!u)return f();const p=d(h.operationId,{next:y=>{switch(y.event){case"operationStorageItems":{s(y.items);break}case"operationStorageDone":{b();break}case"operationError":{v(new Ei(y.error));break}case"operationInaccessible":{v(new Dn);break}default:e($e.continue,[y.operationId])}},error:o});l=()=>{p(),e($e.stopOperation,[h.operationId])};const v=y=>{l=Ft,p(),o(y)},b=()=>{l=Ft,p(),i()};c(h.discardedItems)},onError:o}),()=>{l()}},Wl=e=>{const t=Si(e);return jn((n,r,s,o,i,c)=>{const u=o.startsWith("descendants");let l=u?[]:null;const d=t(s,[{key:i,type:o}],c??null,u?a=>{l.push(a)}:a=>{l=a[0]?.[o]},r,()=>{try{n(u?l.flat():l)}catch(a){r(a)}},a=>{a>0&&(d(),r(new Vn))});return d})},Kl=e=>t=>t.length>0?new Promise((n,r)=>{e($e.unpin,[t],{onSuccess(){n()},onError:r})}):Promise.resolve();class Fn extends Error{constructor(){super("Client destroyed"),this.name="DestroyedError"}}function Xl(e){return e.operationId!==void 0}function Yl(e){return(t,n,r)=>{const s=ki(),o=new Set,i=Fl();let c=i.promise;const u=p=>{if(Xl(p))return s.has(p.operationId)||console.warn("Uknown operationId on",p),s.next(p.operationId,p);if(p.event!=="stop"){if(p.event==="initialized")return n({type:p.event,finalizedBlockHashes:p.finalizedBlockHashes,finalizedBlockRuntime:p.finalizedBlockRuntime});const{event:v,...b}=p;return n({type:v,...b})}r(new xi),a(!1)},l=p=>{r(p),a(!(p instanceof Fn))},h=(p,v)=>{const b=v(p,{next:u,error:l});a=(y=!0)=>{c=null,a=Ot,b(),y&&e($e.unfollow,[p]),s.errorAll(new Ln),o.forEach(g=>{g()}),o.clear()},c=p,i.res(p)},d=p=>{p instanceof Fn?a(!1):r(p),c=null,i.res(p)};let a=e($e.follow,[t],{onSuccess:h,onError:d});const f=(p,v,b)=>{const y=()=>{b?.onError(new Ln)};if(c===null)return y(),Ot;const g=m=>{if(!b)return e(p,[m,...v]);o.add(y);const x=(B,C)=>c===null?(C.error(new Ln),Ot):(s.subscribe(B,C),()=>{s.unsubscribe(B)}),k=e(p,[m,...v],{onSuccess:B=>{o.delete(y),b.onSuccess(B,x)},onError:B=>{o.delete(y),b.onError(B)}});return()=>{o.delete(y),k()}};if(typeof c=="string")return g(c);let w=Ot;return c.then(m=>{if(m instanceof Error)return y();c&&(w=g(m))}),()=>{w()}};return{unfollow(){a(),c=null},body:zl(f),call:Hl(f),header:ql(f),storage:Wl(f),storageSubscription:Si(f),unpin:Kl(f),_request:f}}}var Gl=Object.defineProperty,Nl=(e,t,n)=>t in e?Gl(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Ii=(e,t,n)=>Nl(e,typeof t!="symbol"?t+"":t,n);class Bi extends Error{constructor(t){super(t.message),Ii(this,"code"),Ii(this,"data"),this.code=t.code,this.data=t.data,this.name="RpcError"}}let Ql=1;const Zl=e=>{let t=Ql++;const n=new Map,r=ki();let s=null;const o=(h,d,a)=>{s.send(JSON.stringify({jsonrpc:"2.0",id:h,method:d,params:a}))};function i(h){try{let d,a,f,p,v;if({id:d,result:a,error:f,params:p}=JSON.parse(h),d){const g=n.get(d);return g?(n.delete(d),f?g.onError(new Bi(f)):g.onSuccess(a,(w,m)=>{const x=w;return r.subscribe(x,m),()=>{r.unsubscribe(x)}})):void 0}if({subscription:v,result:a,error:f}=p,!v||!f&&!Object.hasOwn(p,"result"))throw 0;const y=v;f?r.error(y,new Bi(f)):r.next(y,a)}catch(d){console.warn("Error parsing incomming message: "+h),console.error(d)}}s=e(i);const c=()=>{s?.disconnect(),s=null,r.errorAll(new Fn),n.forEach(h=>h.onError(new Fn)),n.clear()};let u=1;return{request:(h,d,a)=>{if(!s)throw new Error("Not connected");const f=`${t}-${u++}`;return a&&n.set(f,a),o(f,h,d),()=>{n.delete(f)}},disconnect:c}},Jl=e=>{const t=jn((r,s,o,i)=>e(o,i,{onSuccess:r,onError:s}));let n=null;return async()=>n||(n=Promise.all([t(Mn.chainName,[]),t(Mn.genesisHash,[]),t(Mn.properties,[])]).then(([r,s,o])=>({name:r,genesisHash:s,properties:o})))},zn=new Map,ef=e=>{const t=zn.get(e);if(t)return t.refCount++,t.client;const{request:n,disconnect:r}=Zl(e),s=()=>{const i=zn.get(e);!i||i.refCount<=1?(zn.delete(e),r()):i.refCount--},o={chainHead:Yl(n),transaction:jl(n),getChainSpecData:Jl(n),destroy:s,request:jn((i,c,u,l)=>n(u,l,{onSuccess:i,onError:c})),_request:n};return zn.set(e,{client:o,refCount:1}),o};var tf=Object.defineProperty,nf=(e,t,n)=>t in e?tf(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,_i=(e,t,n)=>nf(e,typeof t!="symbol"?t+"":t,n);class rf{constructor(){_i(this,"first"),_i(this,"last")}getRemoveFn(t){return()=>{t.prev?t.prev.next=t.next:this.first=t.next,t.next?t.next.prev=t.prev:this.last=t.prev,delete t.prev,delete t.next}}push(t){const n={value:t};return this.last===void 0?this.last=this.first=n:(this.last.next=n,n.prev=this.last,this.last=n),this.getRemoveFn(n)}unshift(t){return this.first={value:t,next:this.first},this.first.next&&(this.first.next.prev=this.first),this.last||(this.last=this.first),this.getRemoveFn(this.first)}pop(){const t=this.first?.value;return this.first&&(this.first=this.first.next,this.first?(delete this.first.prev?.next,delete this.first.prev):this.last=void 0),t}isEmpty(){return!this.first}}const sf=()=>{const e=new Map,t=(a,f)=>{e.set(a,()=>{e.delete(a),f()})},n=a=>{e.get(a)?.()},r=new rf,s=r.unshift.bind(r),o=r.push.bind(r),i=(a,f)=>{const p=f?s:o;t(a.source$,p(a))},c=()=>{const a=r.pop();a&&(e.delete(a.source$),u(a))},u=a=>{const{source$:f,observer:p}=a;let v=!1;const b=f.subscribe({next(y){p.next(y)},error(y){(v=y instanceof Vn)?i(a,!0):p.error(y)},complete(){p.complete()}});b.closed?v||c():t(f,()=>{b.unsubscribe(),c()})},l=(a=!1)=>f=>new T(p=>{const v={observer:p,source$:f};return r.isEmpty()?u(v):i(v,a),()=>{n(f)}}),h=l();return{withRecovery:l,withRecoveryFn:a=>(...f)=>h(a(...f))}};class Tt extends Error{constructor(t,n){super(`Block ${t} is not pinned (${n})`),this.name="BlockNotPinnedError"}}const of=new Set(["best","finalized",null]),Ci=e=>{const t=e.pipe(Je(n=>n instanceof Dn?Pn(750).pipe(Ol(()=>t)):$n(()=>n)));return t},cf=(e,t,n)=>r=>(s,...o)=>{if(!of.has(s))return Ci(r(s,...o)).pipe(n(s));const c=(s==="best"?t:e).pipe(ne(1),U(u=>r(u,...o).pipe(n(u))),Je(u=>u instanceof Tt?c:$n(()=>u)));return Ci(c)},Ur=e=>(...t)=>new T(n=>{let r=new AbortController;return e(...t,r.signal).then(s=>{n.next(s),n.complete()},s=>{n.error(s)}),()=>{n.unsubscribe(),r.abort(),r=void 0}}),af=e=>t=>(...n)=>e()[t](...n);function tn(e,t,n){return(r,...s)=>{const o=t(r,...s);return new T(i=>{let c=null,u=!1;const l=()=>{u||(u=!0,c=o.subscribe({next:a=>i.next(a),error:a=>i.error(a),complete:()=>i.complete()}),c.add(()=>{u=!1,c=null}))};let h=!1;const d=e.subscribe({next:a=>{const f=a.blocks.get(r);f?f.recovering?c?.unsubscribe():l():h&&i.error(new Tt(r,n)),h=a.recovering},error:a=>i.error(a)});return()=>{d.unsubscribe(),c?.unsubscribe()}})}}const uf=e=>e.pipe(Jt(({reportedBlocks:t},{blocks:n})=>{const r=new Set(n.keys()),s=[];return r.size>t.size&&n.forEach(({hash:o,number:i,parent:c})=>{t.has(o)||s.push({hash:o,number:i,parent:c})}),{reportedBlocks:r,newBlocks:s}},{reportedBlocks:new Set,newBlocks:new Array(0)}),U(({newBlocks:t})=>t),en()),lf=(e,t)=>{const n=(r,s,o,i)=>new T(c=>e().storageSubscription(r,s,o??null,u=>{c.next(u)},u=>{c.error(u)},()=>{c.complete()},u=>{u>0&&c.next(n(r,s.slice(-u),o,!0))})).pipe(On(),t(i));return n},ff=e=>t=>new T(n=>{let r=null;return t.subscribe({next(s){s.type==="initialized"?(r=[],e(s.finalizedBlockHashes[0]).then(o=>{n.closed||(n.next({...s,number:o.number,parentHash:o.parentHash}),r.forEach(i=>{n.next(i)}),r=null)}).catch(o=>{n.closed||n.error(o)})):r?r.push(s):n.next(s)},error(s){n.error(s)},complete(){n.complete()}})}),hf=e=>{let t=null,n=_e;const r=()=>{if(!t)throw new Error("Missing chainHead subscription");return t},s=c=>r().header(c).then(ho.dec),o=Il(new T(c=>{t=e(!0,u=>{c.next(u)},u=>{t=null,c.error(u)}),n=()=>{c.complete(),t?.unfollow()}}).pipe(ff(s),df()));return{getHeader:s,getFollower:r,startFollow:()=>(o.connect(),()=>{n()}),follow$:o}},df=()=>e=>new T(t=>{const n=new gt,r=()=>e.subscribe({next:s=>t.next(s),error:s=>{n.add(r()),s instanceof xi?t.next({type:"stop-error"}):console.warn("ChainHead follow request failed, retrying\u2026",s)},complete:()=>t.complete()});return n.add(r()),n}),$i=(e,t)=>e.type==="array"&&e.len===t&&e.value.type==="primitive"&&e.value.value==="u8",lt={type:"void"},pf=(e,t=()=>null)=>{const n=new Map,r=new Set,s=h=>d=>{let a=n.get(d);if(a)return a;if(r.has(d)){const p={id:d};return n.set(d,p),p}r.add(d);const f=h(d);return a=n.get(d),a?Object.assign(a,f):(a={id:d,...f},n.set(d,a)),r.delete(d),a};let o=!0,i=!0;const c=s(h=>{const d=t(e[h]);if(d)return d;const{def:a,path:f,params:p}=e[h];if(a.tag==="composite"){if(a.value.length===0)return lt;if(a.value.length===1){const v=c(a.value[0].type);return o&&f.at(-1)==="AccountId32"&&$i(v,32)?(o=!1,{type:"AccountId32"}):i&&f.at(-1)==="AccountId20"&&$i(v,20)?(i=!1,{type:"AccountId20"}):v}return u(a.value)}if(a.tag==="variant"){if(f.length===1&&f[0]==="Option"&&p.length===1&&p[0].name==="T"){const y=c(p[0].type);return y.type==="void"?{type:"primitive",value:"bool"}:{type:"option",value:y}}if(f.length===1&&f[0]==="Result"&&p.length===2&&p[0].name==="T"&&p[1].name==="E")return{type:"result",value:{ok:c(p[0].type),ko:c(p[1].type)}};if(a.value.length===0)return lt;const v={},b={};return a.value.forEach(y=>{const g=y.name;if(b[g]=y.docs,y.fields.length===0){v[g]={...lt,idx:y.index};return}if(y.fields.length===1&&!y.fields[0].name){v[g]={type:"lookupEntry",value:c(y.fields[0].type),idx:y.index};return}v[g]={...u(y.fields),idx:y.index}}),{type:"enum",value:v,innerDocs:b}}if(a.tag==="sequence")return{type:"sequence",value:c(a.value)};if(a.tag==="array"){const{len:v}=a.value,b=c(a.value.type);return!v||b.type==="void"?lt:v>1?{type:"array",value:b,len:a.value.len}:b}if(a.tag==="tuple")return a.value.length===0?lt:a.value.length>1?l(a.value.map(v=>c(v)),a.value.map(v=>e[v].docs)):c(a.value[0]);if(a.tag==="primitive")return{type:"primitive",value:a.value.tag};if(a.tag==="compact"){const v=c(a.value);return v.type==="void"?lt:{type:"compact",isBig:Number(v.value.slice(1))>32,size:v.value}}return{type:a.tag}}),u=h=>{let d=!0;const a={},f={};return h.forEach((p,v)=>{d=d&&!!p.name;const b=p.name||v,y=c(p.type);y.type!=="void"&&(a[b]=y,f[b]=p.docs)}),d?{type:"struct",value:a,innerDocs:f}:l(Object.values(a),Object.values(f))},l=(h,d)=>{if(h.every(a=>a.id===h[0].id)&&d.every(a=>!a.length)){const[a]=h;return a.type==="void"?lt:{type:"array",value:h[0],len:h.length}}return{type:"tuple",value:h,innerDocs:d}};return c},Hn=e=>{const t=pf(e.lookup,({def:s})=>{if(s.tag==="composite"){const o=n(s);if(o)return{type:"enum",innerDocs:{},value:Object.fromEntries(e.pallets.map(i=>[i.name,i.errors==null?{...lt,idx:i.index}:{type:"lookupEntry",value:t(i.errors.type),idx:i.index}])),byteLength:o}}return null});function n(s){if(!(s.value.length===2&&s.value[0].name==="index"&&s.value[1].name==="error"))return null;const i=t(s.value[0].type),c=t(s.value[1].type);return i.type==="primitive"&&i.value==="u8"&&c.type==="array"&&c.value.type==="primitive"&&c.value.value==="u8"?1+c.len:null}return Object.assign(t,{metadata:e,call:"call"in e.extrinsic?e.extrinsic.call:e.lookup[e.extrinsic.type]?.params.find(i=>i.name==="Call")?.type??null})},vf=(e,t,n)=>(r,s,o,...i)=>{const{id:c}=r;if(s.has(c))return s.get(c);if(o.has(c)){const l=t(()=>s.get(c),r,...i);return s.set(c,l),l}o.add(c);let u=e(r,s,o,...i);return o.delete(c),s.has(c)&&(u=n(u,s.get(c),r,...i)),s.set(c,u),u},bf=Wt(),Oi=vf((e,t,n,r)=>{if(e.type==="primitive")return Ro[e.value];if(e.type==="void")return $;if(e.type==="AccountId32")return r;if(e.type==="AccountId20")return uo;if(e.type==="compact")return e.isBig?gn:_;if(e.type==="bitSequence")return Ys;const s=f=>Oi(f,t,n,r),o=(f,p)=>{const v=s(f);return p?ge(v,p):ge(v)},i=f=>Re(...f.map(s)),c=f=>{const p=Object.fromEntries(Object.entries(f).map(([v,b])=>[v,s(b)]));return me(p)};if(e.type==="sequence"&&e.value.type==="primitive"&&e.value.value==="u8")return bf;if(e.type==="array")return e.value.type==="primitive"&&e.value.value==="u8"?Wt(e.len):o(e.value,e.len);if(e.type==="sequence")return o(e.value);if(e.type==="tuple")return i(e.value);if(e.type==="struct")return c(e.value);if(e.type==="option")return ct(s(e.value));if(e.type==="result")return wn(s(e.value.ok),s(e.value.ko));const u=Object.values(e.value).map(f=>{switch(f.type){case"void":return $;case"lookupEntry":return s(f.value);case"tuple":return i(f.value);case"struct":return c(f.value);case"array":return o(f.value,f.len)}}),l=Object.fromEntries(Object.keys(e.value).map((f,p)=>[f,u[p]])),h=Object.values(e.value).map(f=>f.idx),a=h.every((f,p)=>f===p)?pe(l):pe(l,h);return e.byteLength?yf(a,e.byteLength):a},sr,e=>e),Ti=(e,t=pt())=>{const n=new Map,r=s=>Oi(e(s),n,new Set,t);return s=>r(s)},yf=(e,t)=>{const n=Z(t);return j(r=>n.enc(e.enc(r)),r=>e.dec(n.dec(r)))},mf=Ke($,()=>{},()=>null),Mr=e=>{const{metadata:t}=e;let n=Ti(e);const r=t.pallets.find(a=>a.name==="System")?.constants.find(a=>a.name==="SS58Prefix");let s;if(r)try{const a=n(r.type).dec(r.value);typeof a=="number"&&(s=a,n=Ti(e,pt(a)))}catch{}const o=new Map,i=(a,f)=>{let p=o.get(a);p||o.set(a,p=To(a));const v=t.pallets.find(C=>C.name===a).storage.items.find(C=>C.name===f),b=C=>C===$?mf:C,y=(C,M,...H)=>{const W=p(...H),[,...K]=H;return{args:Re(...K.map(([X])=>X)),keys:W,value:M,len:C,fallback:v.modifier===1?M.dec(v.fallback):void 0}};if(v.type.tag==="plain")return y(0,b(n(v.type.value)),f);const{key:g,value:w,hashers:m}=v.type.value,x=b(n(w)),k=m.map(C=>Ro[C.tag]),B=(()=>{if(k.length===1)return[[n(g),k[0]]];const C=e(g);switch(C.type){case"array":return k.map(M=>[n(C.value.id),M]);case"tuple":return C.value.map((M,H)=>[n(M.id),k[H]]);default:throw new Error("Invalid key type")}})();return y(k.length,x,f,...B)},c=a=>{switch(a.type){case"void":return $;case"lookupEntry":return n(a.value.id);case"tuple":return Re(...Object.values(a.value).map(f=>n(f.id)));case"struct":return me(At(a.value,f=>n(f.id)));case"array":return ge(n(a.value.id),a.len)}},u=(a,f)=>{const p=t.pallets.find(v=>v.name===a).constants.find(v=>v.name===f);return n(p.type)},l=a=>(f,p)=>{const v=t.pallets.find(g=>g.name===f),b=e(v[a].type);if(b.type!=="enum")throw null;const y=b.value[p];return{location:[v.index,y.idx],codec:c(b.value[p])}},h=(a,f)=>{const p=t.pallets.find(v=>v.name===a)?.viewFns.find(v=>v.name===f);if(!p)throw null;return{args:Re(...p.inputs.map(v=>n(v.type))),value:n(p.output)}},d=(a,f)=>{const p=t.apis.find(v=>v.name===a)?.methods.find(v=>v.name===f);if(!p)throw null;return{args:Re(...p.inputs.map(v=>n(v.type))),value:n(p.output)}};return{buildDefinition:n,buildStorage:i,buildEvent:l("events"),buildError:l("errors"),buildViewFn:h,buildRuntimeCall:d,buildCall:l("calls"),buildConstant:u,ss58Prefix:s}},gf=e=>J(Te.enc(e)),Pi=Z(),wf=ct(Pi),xf=ge(Te).dec,Ef=(e,t,n,r)=>{const s=o=>{const i=a=>{const f=(...p)=>{const v=o();return v?a(v,...p).pipe(Je(b=>{if(b instanceof Tt)return f(...p);if(b instanceof Dn)return Pn(750).pipe(U(()=>f(...p)));throw b})):wt};return f},c=i(e),u=i(t),l=c("Metadata_metadata_versions","").pipe(S(xf),Je(()=>Ee([14]))),h=a=>{const[f]=a.filter(p=>p>13&&p<17).sort((p,v)=>v-p);return f===14?c("Metadata_metadata","").pipe(S(Pi.dec)):c("Metadata_metadata_at_version",gf(f)).pipe(S(p=>wf.dec(p)))},d=l.pipe(U(h));return u().pipe(U(a=>n(a).pipe(Je(()=>Ee(null)),U(f=>f?Ee(f):d.pipe(Tr(p=>{r(a,p)}))),S(f=>({codeHash:a,metadataRaw:f,metadata:Xt(yt.dec(f))})))))};return o=>{const i=o(),c=new Set([i]),u=s(o).pipe(S(({metadata:h,metadataRaw:d,codeHash:a})=>{const f=Hn(h),p=Mr(f),v=p.buildStorage("System","Events"),b=h.extrinsic.signedExtensions.find(g=>g.identifier==="ChargeAssetTxPayment");let y=null;if(b){const g=f(b.type);if(g.type==="struct"){const w=g.value.asset_id;w.type==="option"&&(y=w.value.id)}}return{assetId:y,metadataRaw:d,codeHash:a,lookup:f,dynamicBuilder:p,events:{key:v.keys.enc(),dec:v.value.dec},accountId:pt(p.ss58Prefix)}}),Rn(1)),l={at:i,runtime:u,addBlock:h=>(c.add(h),l),deleteBlocks:h=>(h.forEach(d=>{c.delete(d)}),c.size),usages:c};return u.subscribe({error(){}}),l}},nn=en({connector:()=>new Cn(1),resetOnError:!0,resetOnComplete:!0,resetOnRefCountZero:!0}),Ri=(e,t)=>()=>{const n=e.runtimes[t];return n?[...n.usages].at(-1)??null:e.blocks.has(t)?t:null},Ui=(e,t)=>{e.get(e.get(t).parent)?.children.delete(t),e.delete(t)},kf=(e,t)=>{t.forEach(n=>{Ui(e.blocks,n)}),Object.entries(e.runtimes).map(([n,r])=>({key:n,usages:r.deleteBlocks(t)})).filter(n=>n.usages===0).map(n=>n.key).forEach(n=>{delete e.runtimes[n]})},Af=(e,t,n,r,s,o,i,c)=>{const u=new Le,l=u.pipe(Ll(()=>Pn(0)),S(()=>({type:"cleanup"}))),h=$r(o,l,e).pipe(Jt((a,f)=>{const p=v=>{kf(a,v),i(v)};switch(f.type){case"initialized":a.recovering&&(f.finalizedBlockHashes.some(w=>a.blocks.has(w))||(a=Mi()));const[v]=f.finalizedBlockHashes.slice(-1);a.finalized=a.best=v;const b=f.finalizedBlockHashes.length-1;f.finalizedBlockHashes.forEach((g,w)=>{const m=a.blocks.get(g);m?(m.recovering=!1,m.unpinnable=w!==b):a.blocks.set(g,{hash:g,parent:w===0?f.parentHash:f.finalizedBlockHashes[w-1],children:new Set(w===b?[]:[f.finalizedBlockHashes[w+1]]),unpinnable:w!==b,runtime:g,refCount:0,number:f.number+w,recovering:!1})});const y=Object.values(a.runtimes).find(g=>g.usages.has(v));return a.finalizedRuntime=y??(a.runtimes[v]=d(Ri(a,v))),a;case"stop-error":for(const g of a.blocks.values())g.recovering=!0;return a.recovering=!0,a;case"newBlock":{const{parentBlockHash:g,blockHash:w}=f;if(a.blocks.has(w))a.blocks.get(w).recovering=!1;else{const m=a.blocks.get(g);m.children.add(w);const x={hash:w,number:m.number+1,parent:g,children:new Set,runtime:f.newRuntime?w:m.runtime,unpinnable:!1,refCount:0,recovering:!1};a.blocks.set(w,x),f.newRuntime&&(a.runtimes[w]=d(Ri(a,w))),a.runtimes[x.runtime].addBlock(w)}return a}case"bestBlockChanged":{if(a.recovering){for(const[g,w]of a.blocks)w.recovering&&(Ui(a.blocks,g),c(g));a.recovering=!1}return a.best=f.bestBlockHash,a}case"finalized":{a.finalized=f.finalizedBlockHashes.slice(-1)[0];const{blocks:g}=a;g.get(a.best).number<g.get(a.finalized).number&&(a.best=a.finalized),a.finalizedRuntime=a.runtimes[g.get(a.finalized).runtime],f.prunedBlockHashes.forEach(m=>{const x=a.blocks.get(m);x&&(x.unpinnable=!0)});let w=g.get(g.get(a.finalized).parent);for(;w&&!w.unpinnable;)w.unpinnable=!0,w=g.get(w.parent);return u.next(),a}case"cleanup":{const g=[...a.blocks.values()].filter(({unpinnable:w,refCount:m})=>w&&!m).map(({hash:w})=>w);return p(g),a}case"blockUsage":{if(!a.blocks.has(f.value.hash))return a;const g=a.blocks.get(f.value.hash);if(g.refCount+=f.value.type==="hold"?1:-1,g.refCount===0&&!g.recovering&&g.unpinnable){const w=[g.hash];p(w)}return a}}},Mi()),Ce(a=>!!a.finalizedRuntime.runtime),S(a=>({...a})),nn),d=Ef(tn(h,t,"pinned-blocks"),tn(h,n,"pinned-blocks"),r,s);return h},Mi=()=>({best:"",finalized:"",runtimes:{},blocks:new Map,finalizedRuntime:{},recovering:!1}),Li=(e,t,n,r)=>{const s=c=>gi(e.pipe(Ce(({blocks:u})=>!u.has(c)))),o=(c,u,l)=>{if(l)return Ee({hash:c,found:{type:!1,validity:null}});const h=s(c);return t(c).pipe(U(d=>{const a=d.indexOf(u);return a>-1?h(r(c)).pipe(S(f=>({hash:c,found:{type:!0,index:a,events:f}}))):n(c,u).pipe(S(f=>({hash:c,found:{type:!1,validity:f}})))}),h)},i=(c,u,l)=>o(c,u,l.has(c)).pipe(U(h=>{const{found:d}=h;return d.type||d.validity?.success===!1?Ee(h):e.pipe(s(c),U(a=>a.blocks.get(c).children),Ul(),U(a=>i(a,u,l)))}));return c=>e.pipe(ne(1),U(u=>i(u.finalized,c,new Set(u.blocks.keys()))))},Sf=new Uint8Array([2]),If=(e,t)=>J(re(Sf,le(e),le(t))),Vi="TaggedTransactionQueue",Di="validate_transaction",[,Bf]=pe({InvalidTransaction:pe({Call:$,Payment:$,Future:$,Stale:$,BadProof:$,AncientBirthBlock:$,ExhaustsResources:$,Custom:F,BadMandatory:$,MandatoryValidation:$,BadSigner:$}),UnknownTransaction:pe({CannotLookup:$,NoUnsignedValidator:$,Custom:F})}),_f=ln(e=>{const t=F.dec(e);if(t>1)throw new Error("Unable to decode validateTransaction result");if(!t)return{success:!0,value:void 0};let n;try{n=Bf(e)}catch{n={type:"UnknownInvalidTx"}}return{success:!1,value:n}}),Cf=(e,t)=>(n,r)=>{const s=t(n).pipe(S(o=>{try{return o.dynamicBuilder.buildRuntimeCall(Vi,Di).value[1]}catch{return _f}}));return e(n,`${Vi}_${Di}`,If(r,n)).pipe(Pr(s),S(([o,i])=>i(o)))},$f=e=>t=>new T(n=>{let r=!1;const s=t.subscribe({next(o){r=!0,n.next(o)},error(o){n.error(o)},complete(){n.complete()}});return r||n.next(e),s}),Of=e=>t=>new T(n=>{const r=t.subscribe({next(o){n.next(o)},error(o){n.error(o)},complete(){n.complete()}}),s=()=>r.unsubscribe();return()=>{Promise.resolve().then(s)}}),ji=(e,t=1/0)=>n=>new T(r=>{let s;const o=new Map,i=new Map,c=new Map;let u=0,l=0,h=0;const d=()=>{const a=o.get(l);if(!a){i.size===0&&(typeof s>"u"||s.closed)&&r.complete();return}const f=l++;o.delete(f),h!==f&&c.set(f,[]);let p=!1,v=a.subscribe({next(b){h===f?r.next(b):c.get(f).push(b)},complete(){if(p=!0,i.delete(f),f===h)for(h++;c.has(h)&&(c.get(h).forEach(b=>r.next(b)),c.delete(h),!i.has(h));)h++;d()},error(b){r.error(b)}});p||i.set(f,v)};return s=new gt,s.add(n.subscribe({next(a){const f=u++;o.set(f,Tn(()=>e(a,f))),i.size<t&&d()},error(a){r.error(a)},complete(){i.size===0&&r.complete()}})),()=>{i.forEach(a=>a.unsubscribe()),s.unsubscribe(),o.clear(),c.clear()}}),Lr=({hash:e,number:t,parent:n})=>({hash:e,number:t,parent:n}),Tf=(e,t,n)=>{const{getFollower:r,startFollow:s,follow$:o,getHeader:i}=hf(e),c=af(r),{withRecovery:u,withRecoveryFn:l}=sf(),h=new Le,d=E=>(h.next({type:"blockUsage",value:{type:"hold",hash:E}}),()=>{setTimeout(()=>{h.next({type:"blockUsage",value:{type:"release",hash:E}})},0)}),a=E=>I=>new T(P=>{const G=d(E),ie=I.subscribe(P);return ie.add(G),ie}),f=E=>(I,...P)=>E(I,...P).pipe(a(I)),p=(E,I)=>(P,...G)=>new T(ie=>{let ye=!1;return m.pipe(ne(1)).subscribe(Oe=>{ye=Oe.blocks.has(P)}),ye?E(P,...G).subscribe(ie):ie.error(new Tt(P,I))}),v=E=>r().unpin(E).catch(I=>{if(!(I instanceof Ln))throw I}),b=(E,I)=>p(f(tn(m,l(Ur(E)),`stop-${I}`)),I),y=new Map,g=f(l(Ur(c("storage")))),w=E=>g(E,"hash","0x3a636f6465",null).pipe(S(I=>I)),m=Af(o,f(l(Ur(c("call")))),w,t,n,h,E=>{v(E),E.forEach(I=>{y.delete(I)})},E=>{y.delete(E)}),x=f(E=>m.pipe(ne(1),U(I=>I.runtimes[I.blocks.get(E).runtime].runtime))),k=E=>I=>I.pipe(ji(P=>x(E(P)).pipe(S(G=>[P,G])))),B=(E,I,P)=>{const G=y.get(E)??new Map,ie=G.get(I);if(ie)return ie;y.set(E,G);let ye;const Oe=P.pipe(en({connector:()=>ye=new Cn}),Tr({complete(){G.set(I,ye)}}),Of());return G.set(I,Oe),Oe},C=m.pipe(Ce(E=>!E.recovering),fe((E,I)=>E.finalized===I.finalized),Jt((E,I)=>{let P=I.blocks.get(I.finalized);const G=[P],ie=E.at(-1);if(!ie)return G;for(;P.number>ie.number+1&&(P=I.blocks.get(P.parent),!!P);)G.unshift(P);return G},[]),On(),S(Lr),nn),M=m.pipe(fe((E,I)=>E.best===I.best),S(E=>Lr(E.blocks.get(E.best))),nn),H=m.pipe(Ce(E=>!E.recovering),fe((E,I)=>E.finalized===I.finalized&&E.best===I.best),Jt((E,I)=>{const P=Ae=>E.get(Ae)||Lr(I.blocks.get(Ae)),G=P(I.best),ie=P(I.finalized),ye=G.number-ie.number+1,Oe=new Array(ye);for(let Ae=0,an=G.hash;Ae<ye;Ae++)Oe[Ae]=P(an),an=Oe[Ae].parent;return new Map(Oe.map(Ae=>[Ae.hash,Ae]))},new Map),S(E=>[...E.values()]),nn),W=m.pipe(fe((E,I)=>E.finalizedRuntime===I.finalizedRuntime),Un(({finalizedRuntime:{runtime:E}})=>E.pipe($f(null))),nn),K=W.pipe(S(E=>E?.lookup.metadata??null)),X=cf(C.pipe(S(E=>E.hash)),M.pipe(S(E=>E.hash)),a),We=X(b(c("body"),"body")),Ut=E=>B(E,"body",We(E)),on=b(c("storage"),"storage"),cn=X((E,I,P,G=null,ie)=>m.pipe(ne(1),U(ye=>ye.runtimes[ye.blocks.get(E).runtime].runtime),U(ye=>{const Oe=P(ye),Ae=B(E,`storage-${I}-${Oe}-${G??""}`,on(E,I,Oe,G));return ie?B(E,`storage-${I}-${Oe}-${G??""}-dec`,Ae.pipe(S(an=>({raw:an,mapped:ie(an,ye)})))):Ae}))),Ph=lf(r,u),Rh=X(tn(m,(E,I,P)=>Ph(E,I,P??null,!1),"storageQueries")),Uh=X(tn(m,E=>Tn(()=>i(E)),"header")),cc=E=>cn(E,"value",I=>I.events.key,null,(I,P)=>P.events.dec(I)).pipe(S(I=>I.mapped)),Mh=b(c("call"),"call"),ac=X((E,I,P)=>B(E,`call-${I}-${P}`,Mh(E,I,P))),es=Cf(ac,x),uc=E=>B(E,"body",We(E)),Lh=Li(m,uc,es,cc),Vh=Li(m,uc,es,()=>Ee()),Dh=W.pipe(Ce(Boolean),ne(1),U(E=>{const{enc:I}=E.dynamicBuilder.buildStorage("System","BlockHash").keys;let P;try{P=I(0)}catch{P=I(0n)}return cn(null,"value",()=>P,null)}),Rn(1));$r(W,H).subscribe({error(){}});let ts=_e,Gn=!1,ns=0;const jh=E=>{ns+=E,Gn=!0,ts=s()};return[{follow$:o,finalized$:C,best$:M,bestBlocks$:H,newBlocks$:uf(m),runtime$:W,metadata$:K,genesis$:Dh,header$:Uh,body$:Ut,call$:ac,storage$:cn,storageQueries$:Rh,eventsAt$:cc,holdBlock:d,trackTx$:Lh,trackTxWithoutEvents$:Vh,validateTx$:es,pinnedBlocks$:m,withRuntime:k,getRuntimeContext$:X(x),unfollow:()=>{Gn!=null&&(ns--,Gn&&!ns&&(Gn=null,ts(),ts=_e))}},jh]};var Pf=e=>t=>new T(n=>e(t,r=>{n.error(r)}));const Rf=()=>Ee(null),qn=new Map,Uf=(e,t={})=>{const{getMetadata:n,setMetadata:r}=t,s=qn.get(e);if(s)return s.refCount++,s.client;const o=()=>{const h=qn.get(e);!h||h.refCount<=1?(qn.delete(e),e.destroy()):h.refCount--};let i=null,c=0,u=null;const l={chainHead$:h=>{c++,u||(u=h||1),i||(i=Tf(e.chainHead,n||Rf,r||_e));const[d,a]=i;if(u===c){const f=c;c=0,u=null,i=null,a(f)}return d},broadcastTx$:Pf(e.transaction),destroy:o};return qn.set(e,{client:l,refCount:1}),l},Mf=(e,t)=>e.pipe(wi(n=>n.blocks.has(t)),fe((n,r)=>n.finalized===r.finalized&&n.best===r.best),S(n=>{if(n.blocks.get(t).number>n.blocks.get(n.best).number)return null;const{number:r}=n.blocks.get(t);let s=n.blocks.get(n.best),o=n.finalized===s.hash;for(;s.number>r;)s=n.blocks.get(s.parent),o=o||n.finalized===s.hash;return o?"finalized":s.hash===t?"best":null}),fe(),wi(n=>n!=="finalized",!0));class Pt{constructor(){}_runtime(t){}}class Fi{constructor(){}_compatibility(t){}}const Wn=new WeakMap,zi=new WeakMap,Vr=e=>e instanceof Pt?zi.get(e):Wn.get(e);var ft=(e=>(e.Storage="storage",e.Tx="tx",e.Event="events",e.Const="constants",e.ViewFns="viewFns",e.Api="apis",e))(ft||{});const Lf=ge(Cu),Vf=ge(yr),Df=Re(Lf,Vf),jf=(e,t)=>{const n=new Promise(async r=>{const s=t.runtime$.pipe(Ce(i=>i!=null));let o=await Ve(s);s.subscribe(i=>o=i),r(()=>o)});return Promise.all([e.metadataTypes.then(Df.dec),e.descriptors,n]).then(([[r,s],o,i])=>{const c=new Fi;return Wn.set(c,{runtime:i,getEntryPoint(u,l,h){const d=o[u]?.[l]?.[h];if(d==null)throw new Error(`Descriptor for ${u} ${l}.${h} does not exist`);return r[d]},typedefNodes:s}),c})},Ff=e=>new Promise(async t=>{const n=e.runtime$.pipe(Ce(s=>s!=null));let r=await Ve(n);n.subscribe(s=>r=s),t(()=>r)}).then(t=>{const n=new Pt;return zi.set(n,{runtime:t}),n}),Dr=new WeakMap,Hi=e=>(Dr.has(e.metadataRaw)||Dr.set(e.metadataRaw,{compat:new Map,lookup:e.lookup,typeNodes:[]}),Dr.get(e.metadataRaw)),Et=(e,t,n)=>{const r=(i,c)=>{var u;const l=Hi(i);return(u=l.typeNodes)[c]||(u[c]=kn(l.lookup(c)))};function s(i,c){if(i instanceof Pt)return{args:Be.Identical,values:Be.Identical};const u=Wn.get(i);c||(c=u.runtime());const l=n(c);if(l==null)return{args:Be.Incompatible,values:Be.Incompatible};const h=u.typedefNodes,d=Hi(c),a=t(u);return Pu(a,f=>h[f],l,f=>r(c,f),d.compat)}const o=Wi(e,i=>qi(s(i)));return{isCompatible:Wi(e,(i,c)=>o(c)>=i),getCompatibilityLevel:o,getCompatibilityLevels:s,descriptors:e,withCompatibleRuntime:(i,c)=>u=>$t([u.pipe(i.withRuntime(c)),e]).pipe(S(([[l,h],d])=>[l,d,h])),compatibleRuntime$:(i,c)=>$t([e,i.getRuntimeContext$(c)]),argsAreCompatible:(i,c,u)=>{if(i instanceof Pt)return!0;const l=s(i,c);if(l.args===Be.Incompatible)return!1;if(l.args>Be.Partial)return!0;if(l.values===Be.Incompatible)return!1;const h=n(c);return h==null?!1:jo(h.args,d=>r(c,d),u)},valuesAreCompatible:(i,c,u)=>{if(i instanceof Pt)return!0;const l=s(i,c).values;if(l===Be.Incompatible)return!1;if(l>Be.Partial)return!0;const h=Wn.get(i),d=t(h);return jo(d.values,a=>h.typedefNodes[a],u)},getRuntimeTypedef:r}},qi=e=>Math.min(e.args,e.values),Wi=(e,t)=>(...n)=>{const r=n.at(-1);return r instanceof Fi||r instanceof Pt?t(...n):e.then(s=>t(...n,s))},zf=(e,t,{valuesAreCompatible:n,descriptors:r,isCompatible:s,getCompatibilityLevel:o})=>{const i=new WeakMap,c=l=>{if(i.has(l))return i.get(l);const h=l.lookup.metadata.pallets.find(a=>a.name===e)?.constants.find(a=>a.name===t);if(h==null)throw new Error(`Runtime entry Constant(${e}.${t}) not found`);const d=l.dynamicBuilder.buildConstant(e,t).dec(h.value);return i.set(l,d),d},u=l=>{if(l){const h=Vr(l).runtime(),d=c(h);if(!n(l,h,d))throw new Error(`Incompatible runtime entry Constant(${e}.${t})`);return d}return r.then(u)};return Object.assign(u,{isCompatible:s,getCompatibilityLevel:o})},Hf=en({connector:()=>new Cn(1),resetOnError:!0,resetOnComplete:!0,resetOnRefCountZero:!0});function Kn(e,t){return new Promise((n,r)=>{let s=null,o=!1;const i=t?()=>{s?.unsubscribe(),r(new Hs)}:_e;s=e.subscribe({next:c=>{n(c),s?.unsubscribe(),o=!0},error:c=>{t?.removeEventListener("abort",i),r(c),o=!0},complete:()=>{t?.removeEventListener("abort",i),r(new Error("Observable completed without emitting")),o=!0}}),o||t?.addEventListener("abort",i)})}const jr=Symbol("EMPTY_VALUE"),Fr=e=>t=>new T(n=>{let r=0,s=null,o=jr,i=!1;const c=()=>{const l=e(o,r++);o=jr,s=l.subscribe({next(h){n.next(h)},error(h){n.error(h)},complete(){o!==jr?c():(s=null,i&&n.complete())}})},u=t.subscribe({next(l){o=l,s||c()},error(l){n.error(l)},complete(){s||n.complete(),i=!0}});return()=>{s?.unsubscribe(),u.unsubscribe()}});let Ki={};const qf=e=>t=>new T(n=>{let r=Ki,s=t.subscribe({next(o){n.next(r=o)},error(o){n.error(o)},complete(){r===Ki?n.complete():s=e(r).subscribe(n)}});return()=>{s.unsubscribe()}}),Rt=e=>typeof e=="object"&&e!==null&&Object.entries(e).every(([t,n])=>t==="at"&&(n===void 0||typeof n=="string")||t==="signal"&&(n===void 0||n instanceof AbortSignal)),Wf=()=>{const e=new Xu(new Le);return[e.pipe(Dl()),()=>Tr({next:t=>e.value.next(t),error:t=>{e.value.error(t),e.next(new Le)},complete:()=>{e.value.complete(),e.next(new Le)}})]},Kf=(e,t,n,{isCompatible:r,getCompatibilityLevel:s,withCompatibleRuntime:o,argsAreCompatible:i,valuesAreCompatible:c})=>{const u=()=>new Error(`Incompatible runtime entry Event(${e}.${t})`),l=n.finalized$.pipe(o(n,h=>h.hash),S(([h,d,a])=>{const f=a.lookup.metadata.pallets.find(p=>p.name===e)?.events?.type;if(f==null||a.lookup.metadata.lookup[f].def.tag!=="variant"||a.lookup.metadata.lookup[f].def.value.find(p=>p.name===t)==null)throw new Error(`Runtime entry Event(${e}.${t}) not found`);if(!i(d,a,null))throw u();return[h,d,a]}),ji(([h,d,a])=>n.eventsAt$(h.hash).pipe(S(f=>f.filter(p=>p.event.type===e&&p.event.value.type===t).map(p=>{if(!c(d,a,p.event.value.value))throw u();return{meta:{phase:p.phase,block:h},payload:p.event.value.value}})))),Hf);return{watch:h=>l.pipe(U(d=>h?d.filter(a=>h(a.payload)):d)),pull:()=>Ve(l),filter:h=>h.filter(d=>d.type===e&&d.value.type===t).map(d=>d.value.value),getCompatibilityLevel:s,isCompatible:r}},Xf=(e,t,n,{isCompatible:r,getCompatibilityLevel:s,compatibleRuntime$:o,argsAreCompatible:i,valuesAreCompatible:c})=>{const u=`${e}_${t}`,l=()=>new Error(`Incompatible runtime entry RuntimeCall(${u})`);return Object.assign((...h)=>{const d=h[h.length-1],a=Rt(d),{signal:f,at:p}=a?d:{},v=p??null,b=o(n,v).pipe(U(([y,g])=>{let w;try{w=g.dynamicBuilder.buildRuntimeCall(e,t)}catch{throw new Error(`Runtime entry RuntimeCall(${u}) not found`)}if(!i(y,g,h))throw l();return n.call$(v,u,J(w.args.enc(h))).pipe(S(w.value.dec),S(m=>{if(!c(y,g,m))throw l();return m}))}));return Kn(b,f)},{getCompatibilityLevel:s,isCompatible:r})},zr=S(e=>e.mapped),Yf=(e,t,n,r,{isCompatible:s,getCompatibilityLevel:o,getCompatibilityLevels:i,descriptors:c,argsAreCompatible:u,valuesAreCompatible:l})=>{const h=e==="System"&&t==="Number",d=e==="System"&&t==="BlockHash",a=n.runtime$.pipe(Ce(Boolean),ne(1),S(({dynamicBuilder:m})=>typeof m.buildStorage("System","Number").value.dec(new Uint8Array(32))=="bigint"?BigInt:Ze),Rn()),f=Ko($l(a),S(([m,x])=>x(m))),p=()=>new Error(`Incompatible runtime entry Storage(${e}.${t})`),v=m=>new Error(`Invalid Arguments calling ${e}.${t}(${m})`),b=m=>{try{return m.dynamicBuilder.buildStorage(e,t)}catch{throw new Error(`Runtime entry Storage(${e}.${t}) not found`)}},y=(...m)=>{const x=m[m.length-1],k=x==="best",B=k||x==="finalized"?m.slice(0,-1):m;return n[k?"best$":"finalized$"].pipe(Fr(()=>g(...B,k?{at:"best"}:{})),fe((C,M)=>C.raw===M.raw),zr)},g=(...m)=>{const x=m[m.length-1],k=Rt(x),{at:B}=k?x:{},C=B??null;return h?n.pinnedBlocks$.pipe(S(M=>{const H=C==="finalized"||!C?M.finalized:C==="best"?M.best:C,W=M.blocks.get(H);if(!W)throw new Tt(H,"System.Number");return W.number}),fe(),f,S(M=>({raw:M,mapped:M}))):d&&Number(m[0])===0?n.genesis$.pipe(S(M=>({raw:M,mapped:mn.fromHex(M)}))):xt(c).pipe(U(M=>n.storage$(C,"value",H=>{const W=b(H),K=m.length===W.len?m:m.slice(0,-1);if(m!==K&&!k)throw v(m);if(!u(M,H,K))throw p();return W.keys.enc(...K)},null,(H,W)=>{const K=b(W),X=H===null?K.fallback:K.value.dec(H);if(!l(M,W,X))throw p();return X})))},w=async(...m)=>{const x=m[m.length-1],k=Rt(x),{signal:B}=k?x:{};return Kn(g(...m).pipe(zr),B)};return{isCompatible:s,getCompatibilityLevel:o,getValue:w,getValues:(m,x)=>Promise.all(m.map(k=>w(...x?[...k,x]:k))),getEntries:async(...m)=>{const x=m[m.length-1],k=Rt(x),{signal:B,at:C}=k?x:{},M=C??null,H=await c,W=n.storage$(M,"descendantsValues",K=>{const X=b(K);if(qi(i(H,K))===Be.Incompatible)throw p();if(m.length>X.len)throw v(m);const We=m.length>0&&k?m.slice(0,-1):m;if(m.length===X.len&&We===m)throw v(m);return X.keys.enc(...We)},null,(K,X)=>{const We=b(X),Ut=K.map(({key:on,value:cn})=>({keyArgs:We.keys.dec(on),value:We.value.dec(cn)}));if(Ut.some(({value:on})=>!l(H,X,on)))throw p();return Ut}).pipe(zr);return Kn(W,B)},watchValue:y,watchEntries:(...m)=>{const x=m.at(-1),k=Rt(x);return r(e,t,k?m.slice(0,-1):m,k&&x.at==="best")}}},Gf=Lt(F.enc,e=>+!!e.signed<<7|e.version),Hr=()=>new Error("Unkown signer"),Nf=e=>{const{extrinsic:t}=e,n=Hn(e);let r,s;if("address"in t)r=n(t.address),s=n(t.signature);else{const o=Object.fromEntries(e.lookup[t.type].params.filter(i=>i.type!=null).map(i=>[i.name,n(i.type)]));if(r=o.Address,s=o.Signature,!r||!s)throw Hr()}if(r.type==="AccountId20"&&s.type==="array"&&s.len===65&&s.value.type==="primitive"&&s.value.value==="u8")return[1,[]];if(s.type!=="enum"||["Ecdsa","Ed25519","Sr25519"].some(o=>!(o in s.value)))throw Hr();if(r.type==="enum"){const o=r.value.Id;if(o.type==="lookupEntry"&&o.value.type==="AccountId32")return[0,[o.idx]]}else if(r.type==="AccountId32")return[0,[]];throw Hr()},Qf={Ed25519:0,Sr25519:1,Ecdsa:2},Zf=(e,t,n,r,s,o)=>{const[i,c]=Nf(e),u=re(Gf({signed:!0,version:4}),i===1?t:new Uint8Array([...c,...t]),i===1||!o?n:new Uint8Array([Qf[o],...n]),...r,s);return re(ae.enc(u.length),u)},[Xn,rn]=["<Bytes>","</Bytes>"].map(e=>Fe.fromText(e).asBytes()),Jf=e=>async t=>{let n=!0,r;for(r=0;n&&r<Xn.length;r++)n=Xn[r]===t[r];n=n&&r===Xn.length;const s=t.length-rn.length;for(r=0;n&&r<rn.length;r++)n=rn[r]===t[s+r];return n=n&&r===rn.length,e(n?t:re(Xn,t,rn))};function eh(e,t,n){return{publicKey:e,signTx:async(s,o,i,c,u=Yt)=>{const l=Xt(dr(i)),h=[],d=[];l.extrinsic.signedExtensions.map(({identifier:p})=>{const v=o[p];if(!v)throw new Error(`Missing ${p} signed extension`);h.push(v.value),d.push(v.additionalSigned)});const a=re(s,...h,...d),f=await n(a.length>256?u(a):a);return Zf(l,e,f,h,s,t)},signBytes:Jf(n)}}Uint8Array.from([1]);const th=(e,t)=>{const n=e.metadata.pallets.find(o=>o.name==="System").constants.find(o=>o.name==="Version"),r=e(n.type),s=t.buildDefinition(n.type).dec;if(r.type!=="struct")throw new Error("not a struct");return s(n.value)};function nh(e){let t=0;for(;!(e&1);)t++,e>>=1;return t}const rh=e=>1<<Math.ceil(Math.log2(e)),sh=Lt(Z(2)[0],e=>{const t=Math.min(Math.max(rh(e.period),4),65536),n=e.startAtBlock%t,r=Math.max(t>>12,1),s=Math.min(Math.max(nh(t)-1,1),15),o=n/r<<4;return tt[0](s|o)}),[oh]=me({tip:ae,asset:ct(Z(1/0))}),Xi=new Uint8Array,qr=Uint8Array.from([0]),Wr=e=>({value:e,additionalSigned:Xi}),Kr=e=>({value:Xi,additionalSigned:e}),Xr=(e,t)=>({value:e,additionalSigned:t}),Yi=(e,t,n)=>{const r={};return t.metadata.extrinsic.signedExtensions.forEach(({identifier:s,type:o,additionalSigned:i})=>{r[s]=[o,i].map(c=>n.buildDefinition(c)[0])}),({mortality:s,tip:o=0n,nonce:i,customSignedExtensions:c={},...u})=>{const l=[],h=th(t,n),d=f=>{const[p,v]=r[f],b=c[f];try{return At({value:p,additionalSigned:v},(y,g)=>{const w=b?.[g];return w instanceof Uint8Array?w:y(w)})}catch{return l.push(f),null}},a=At(r,([f,p],v)=>{if(c[v])return d(v);switch(v){case"CheckNonce":return Wr(f(i));case"CheckMortality":return s.mortal?Xr(sh({period:s.period,startAtBlock:s.startAtBlock.height}),le(s.startAtBlock.hash)):Xr(qr,e);case"ChargeTransactionPayment":return Wr(f(o));case"ChargeAssetTxPayment":return Wr(oh({tip:o,asset:u.asset}));case"CheckGenesis":return Kr(e);case"CheckMetadataHash":return Xr(qr,qr);case"CheckSpecVersion":return Kr(p(h.spec_version));case"CheckTxVersion":return Kr(p(h.transaction_version));default:return d(v)}});return l.forEach(f=>{delete a[f]}),At(a,(f,p)=>({...f,identifier:p}))}},Gi="AccountNonceApi_account_nonce",ih={1:F.dec,2:tt.dec,4:Te.dec,8:Vt.dec},ch=(e,t,n)=>e(n,Gi,t).pipe(S(r=>{const s=le(r),o=ih[s.length];if(!o)throw new Error(`${Gi} retrieved wrong data`);return o(s)})),ah=(e,t,n,r,s,o={})=>$t([o.nonce?Ee(o.nonce):uh(e,J(t.publicKey)),e.getRuntimeContext$(r.hash),e.genesis$]).pipe(ne(1),U(([i,c,u])=>{const l=Yi(le(u),c.lookup,c.dynamicBuilder),h=o.mortality??{period:64,mortal:!0},d=l({nonce:i,tip:o.tip??0n,mortality:h.mortal?{mortal:!0,period:h.period,startAtBlock:{height:r.number,hash:r.hash}}:{mortal:!1},customSignedExtensions:s,asset:o.asset});return t.signTx(n,d,c.metadataRaw,r.number)})),uh=(e,t)=>{const n=o=>e.newBlocks$.pipe(Jt((i,c)=>c.parent===i?c.hash:i,o),mi(o),fe()),r=o=>n(o).pipe(ne(2),Un(i=>ch(e.call$,t,i))),s=o=>$t(o.map(i=>r(i).pipe(S(c=>({success:!0,value:c})),Je(c=>Ee({success:!1,value:c}))))).pipe(ne(1));return e.pinnedBlocks$.pipe(Ce(o=>!o.recovering&&o.blocks.size>0),ne(1),S(({blocks:o,best:i})=>{const c=o.get(i);return[...o.values()].filter(u=>!u.unpinnable&&u.children.size===0&&u.number>=c.number).map(u=>u.hash)}),Un(s),S(o=>{const i=o.reduce((c,u)=>u.success&&u.value>=(c??0)?u.value:c,null);if(i==null)throw o[0].value;return i}))};var lh=Object.defineProperty,fh=(e,t,n)=>t in e?lh(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,hh=(e,t,n)=>fh(e,t+"",n);const dh=e=>J(Yt(le(e))),ph=(e,t)=>new T(n=>{const r=new Map;let s,o;const i=()=>{let u=s.best,l=r.get(u),h=s.blocks.get(u).number;for(;!l;){const f=s.blocks.get(u);if(!f)break;l=r.get(u=f.parent),h--}if(!l)return;const d=h<=s.blocks.get(s.finalized).number,a=l.found.type;if(a&&o?.found&&o.hash===l.hash){d&&n.complete();return}n.next(o=l.found.type?{found:a,hash:l.hash,number:h,index:l.found.index,events:l.found.events}:{found:a,validity:l.found.validity}),d&&(a?n.complete():l.found.validity?.success===!1&&n.error(new Yr(l.found.validity.value)))},c=t.pipe(fe((u,l)=>u.finalized===l.finalized&&u.best===l.best)).subscribe({next:u=>{s=u,r.size!==0&&i()},error(u){n.error(u)}});return c.add(e.subscribe({next:u=>{r.set(u.hash,u),i()},error(u){n.error(u)}})),c}).pipe(fe((n,r)=>n===r)),vh=(e,t)=>{const n=e.filter(s=>s.phase.type==="ApplyExtrinsic"&&s.phase.value===t).map(s=>({...s.event,topics:s.topics})),r=n[n.length-1];return r.type==="System"&&r.value.type==="ExtrinsicFailed"?{ok:!1,events:n,dispatchError:r.value.value.dispatch_error}:{ok:!0,events:n}};class Yr extends Error{constructor(t){super(JSON.stringify(t,(n,r)=>typeof r=="bigint"?r.toString():r instanceof Fe?r.asHex():r,2)),hh(this,"error"),this.name="InvalidTxError",this.error=t}}const Gr=(e,t,n,r,s=!1)=>{const o=dh(n),i=(h,d)=>({type:h,txHash:o,...d}),c=e.pinnedBlocks$.pipe(ne(1),S(h=>{const d=h.blocks.get(r);return d?d.hash:h.finalized})).pipe(U(h=>e.validateTx$(h,n).pipe(Ce(d=>!d.success),S(d=>{throw new Yr(d.value)})))),u=new T(h=>{const d=e.trackTx$(n).subscribe(h);return d.add(t(n).subscribe({error(a){h.error(a)}})),d}),l=ph(u,e.pinnedBlocks$).pipe(S(h=>h.found?i("txBestBlocksState",{found:!0,block:{index:h.index,number:h.number,hash:h.hash},...vh(h.events,h.index)}):i("txBestBlocksState",{found:!1,isValid:h.validity?.success!==!1})));return Cr(s?Ee(i("signed",{})):wt,c,Ee(i("broadcasted",{})),l.pipe(qf(({found:h,type:d,...a})=>h?Ee(i("finalized",a)):wt)))},Ni=async(e,t,n,r)=>hl(Gr(e,t,n,r)).then(s=>{if(s.type!=="finalized")throw null;const o={...s};return delete o.type,o}),bh=pt().enc,yh=new Uint8Array(64),mh=new Uint8Array(65),gh=e=>()=>e?mh:yh,[,wh]=me({weight:me({ref_time:gn,proof_size:gn}),class:pe({Normal:$,Operational:$,Mandatory:$}),partial_fee:cs}),Qi=(e,t,n,r,{isCompatible:s,getCompatibilityLevel:o,compatibleRuntime$:i,argsAreCompatible:c,getRuntimeTypedef:u},l)=>Object.assign(h=>{const d=(m,x,k={})=>{const B=Vr(m).runtime(),{dynamicBuilder:C,assetId:M,lookup:H}=B;let W;try{W=C.buildCall(e,t)}catch{throw new Error(`Runtime entry Tx(${e}.${t}) not found`)}if(l&&!c(m,B,x))throw new Error(`Incompatible runtime entry Tx(${e}.${t})`);let K=k;if(k.asset){if(M==null||!mr(k.asset,kn(H(M)),Ut=>u(B,Ut)))throw new Error("Incompatible runtime asset");K={...k,asset:C.buildDefinition(M).enc(k.asset)}}const{location:X,codec:We}=W;return{callData:Fe.fromBytes(re(new Uint8Array(X),We.enc(x))),options:K}},a=(m,x={})=>i(n,null).pipe(S(([k])=>d(k,m,x))),f=m=>m?d(m,h).callData:Ve(a(h).pipe(S(x=>x.callData))),p=(m,{...x},k)=>a(h,x).pipe(U(({callData:B,options:C})=>ah(n,m,B.asBytes(),k,x.customSignedExtensions||{},C))),v=(m,{at:x,...k}={})=>(!x||x==="finalized"?n.finalized$:x==="best"?n.best$:n.bestBlocks$.pipe(S(B=>B.find(C=>C.hash===x)))).pipe(ne(1),U(B=>B?p(m,k,B).pipe(S(C=>({tx:J(C),block:B}))):$n(()=>new Error(`Uknown block ${x}`)))),b=(m,x)=>Ve(v(m,x)).then(k=>k.tx),y=(m,x)=>Ve(v(m,x)).then(({tx:k,block:B})=>Ni(n,r,k,B.hash)),g=(m,x)=>v(m,x).pipe(U(({tx:k,block:B})=>Gr(n,r,k,B.hash,!0))),w=async(m,x)=>{typeof m=="string"&&(m=m.startsWith("0x")?le(m):bh(m));const k=m.length===20,B=eh(m,k?"Ecdsa":"Sr25519",gh(k)),C=le(await b(B,x)),M=J(re(C,Te.enc(C.length))),H=n.getRuntimeContext$(null).pipe(S(K=>{try{return K.dynamicBuilder.buildRuntimeCall("TransactionPaymentApi","query_info").value[1]}catch{return wh}})),W=n.call$(null,"TransactionPaymentApi_query_info",M);return Ve($t([W,H]).pipe(S(([K,X])=>X(K))))};return{getPaymentInfo:w,getEstimatedFees:async(m,x)=>(await w(m,x)).partial_fee,decodedCall:{type:e,value:bt(t,h)},getEncodedData:f,sign:b,signSubmitAndWatch:g,signAndSubmit:y}},{getCompatibilityLevel:o,isCompatible:s});var xh=Object.defineProperty,Eh=(e,t,n)=>t in e?xh(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,qe=(e,t,n)=>(Eh(e,typeof t!="symbol"?t+"":t,n),n),Nr=Symbol("SUSPENSE"),kh=class extends Promise{constructor(e){super(e)}},Zi=class extends Error{constructor(){super(),this.name="NoSubscribersError"}},Ji=class extends Error{constructor(){super(),this.name="EmptyObservableError"}},ke={},Yn=class extends T{constructor(e,t,n=_e){super(r=>{const s=new Qt({next:r.next.bind(r),error:r.error.bind(r),complete:_e});this.refCount++;let o;r.add(()=>{var i;this.refCount--,o.unsubscribe(),this.refCount===0&&(this.currentValue=ke,this.subscription&&this.subscription.unsubscribe(),n(),(i=this.subject)==null||i.complete(),this.subject=null,this.subscription=null,this.promise&&(this.promise.rej(new Zi),this.promise=null))}),this.subject?(o=this.subject.subscribe(s),this.currentValue!==ke&&r.next(this.currentValue)):(this.subject=new Le,o=this.subject.subscribe(s),this.subscription=null,this.subscription=new Qt({next:i=>{this.promise&&i!==Nr&&(this.promise.res(i),this.promise=null),this.subject.next(this.currentValue=i)},error:i=>{var c;this.subscription=null;const u=this.subject;this.subject=null,this.currentValue=ke;const l=(c=this.promise)==null?void 0:c.rej;l&&i===Nr&&(this.promise.rej=()=>{l(i)}),u.error(i),l&&this.promise&&(this.promise.rej=l)},complete:()=>{if(this.subscription=null,this.promise&&(this.promise.rej(new Ji),this.promise=null),this.currentValue!==ke)return this.subject.complete();if(t===ke){const i=this.subject;return this.subject=null,i.error(new Ji)}this.subject.next(this.currentValue=t),this.subject.complete()}}),e.subscribe(this.subscription),t!==ke&&this.currentValue===ke&&this.subject.next(this.currentValue=t))}),this.defaultValue=t,qe(this,"subject",null),qe(this,"subscription",null),qe(this,"refCount",0),qe(this,"currentValue",ke),qe(this,"promise",null),qe(this,"pipeState",(...r)=>{const s=super.pipe(...r);return s instanceof Yn?s:new Yn(s,ke)}),qe(this,"getRefCount",()=>this.refCount),qe(this,"getValue",()=>{if(this.promise)return this.promise.p;if(this.currentValue!==ke&&this.currentValue!==Nr)return this.currentValue;if(this.defaultValue!==ke)return this.defaultValue;if(this.refCount===0)throw new Zi;const r=new kh((s,o)=>{this.promise={res:s,rej:o,p:null}});return this.promise.p=r,r}),qe(this,"getDefaultValue",()=>this.defaultValue),t===ke&&delete this.getDefaultValue}};function ec(e,t){t.getValue=e.getValue,t.getRefCount=e.getRefCount,t.pipeState=e.pipeState,e.getDefaultValue&&(t.getDefaultValue=e.getDefaultValue)}function Ah(e,t){const n=new Sh,r=typeof t=="function"?t:()=>t,s=o=>{for(let d=o.length-1;o[d]===void 0&&d>-1;d--)o.splice(-1);const i=[o.length,...o],c=n.get(i);if(c!==void 0)return c;const u=new Yn(e(...o),r(...o),()=>{n.delete(i)}),l=new T(d=>{const a=n.get(i);let f=u;return a?a!==l&&(f=a,ec(f,l)):n.set(i,h),f.subscribe(d)});ec(u,l);const h=l;return n.set(i,h),h};return(...o)=>s(o)}var Sh=class{constructor(){qe(this,"root"),this.root=new Map}get(e){let t=this.root;for(let n=0;n<e.length;n++)if(t=t.get(e[n]),!t)return;return t}set(e,t){let n=this.root,r;for(r=0;r<e.length-1;r++){let s=n.get(e[r]);s||(s=new Map,n.set(e[r],s)),n=s}n.set(e[r],t)}delete(e){const t=[this.root];let n=this.root;for(let s=0;s<e.length-1;s++)t.push(n=n.get(e[s]));let r=t.length-1;for(t[r].delete(e[r]);--r>-1&&t[r].get(e[r]).size===0;)t[r].delete(e[r])}};function Ih(e,t){return new Yn(e,t)}var Qr=(...e)=>(typeof e[0]=="function"?Ah:Ih)(e[0],e.length>1?e[1]:ke);const tc=(e,t,n)=>{const r=new Map(t.map(c=>[c.key,c])),s=new Map(e.map(c=>[c.key,c])),o=new Map,i=[];return t.forEach(c=>{const{key:u}=c,l=s.get(u);(!l||l.value!==c.value)&&o.set(u,n(c))}),e.forEach(c=>{r.has(c.key)||i.push(c)}),{deltas:{deleted:i,upserted:[...o.values()]},entries:t.map(({key:c})=>o.get(c)??s.get(c))}},nc=(e,t,n,r=!1)=>{try{let s=r?e:n.blocks.get(e).parent;for(;s&&!t[s];)s=n.blocks.get(s).parent;return s?t[s]:null}catch{return null}},rc=(e,t)=>n=>{const{keys:r,value:s}=n.dynamicBuilder.buildStorage(e,t);return o=>(o.dec={value:s.dec(o.value),args:r.dec(o.key)},o)},Bh=(e,t,n)=>{const r=Qr((c,u,l)=>{const h=rc(c,u),d=(b,y)=>{const g=Mf(e,y.hash).pipe(Ce(w=>!w),ne(1));return t(y.hash,"closestDescendantMerkleValue",()=>l).pipe(U(w=>w===b?.rootHash?Ee({...b,block:y,deltas:null,prev:b.block.hash}):t(y.hash,"descendantsValues",()=>l).pipe(n(()=>y.hash),S(([m,x])=>[m,h(x)]),S(([m,x])=>({prev:b&&b.block.hash,rootHash:w,block:y,...tc(b?.entries??[],m,x)})))),gi(g),Je(w=>w instanceof Tt?wt:$n(()=>w)))},a=e.pipe(fe((b,y)=>b.finalized===y.finalized),Fr(({blocks:b,finalized:y})=>d(null,b.get(y))),ne(1),S(b=>({blocks:{[b.block.hash]:b},finalized:b.block.hash}))),[f,p]=Wf(),v=e.pipe(fe((b,y)=>b.best===y.best),Pr(f),Fr(([b,y])=>{const{best:g}=b,{blocks:w}=y;let m=w[g]?null:g;if(!m)return wt;const x=nc(m,w,b);return x?d(x,b.blocks.get(m)).pipe(S(k=>(w[m]=k,y))):(m=b.finalized,d(w[y.finalized],b.blocks.get(m)).pipe(S(k=>(k.prev=null,{blocks:{[m]:k},finalized:m}))))}));return $r(a,v).pipe(p())}),s=c=>(u,l,h)=>{const d=r(u,l,h),a=rc(u,l),f=c?"finalized":"best";return $t([d.pipe(Rl(0)),e.pipe(fe((p,v)=>p[f]===v[f]))]).pipe(S(([p,v])=>nc(v[f],p.blocks,v,!0)),Ce(Boolean),fe(),mi(null),Vl(),Pr(d),n(([[,p]])=>p.block.hash),S(([[[p,v],b],y])=>[p,v,b,a(y)]),U(([p,v,b,y])=>{if(!p)return[v];let g=v;const w=[];for(;g&&g.block.number>p.block.number;)w.unshift(g),g=g.prev?b.blocks[g.prev]:null;if(c&&(b.finalized=v.block.hash,w.length)){const{blocks:m}=b;Object.keys(m).forEach(x=>{m[x].block.number<w[0].block.number&&delete m[x]})}return p===g?w:[{...v,...p.rootHash===v.rootHash?{entries:p.entries,deltas:null}:tc(p.entries,v.entries,y)}]}))},o=Qr(s(!0)),i=Qr(s(!1));return(c,u,l,h)=>{const d=h?i:o;return e.pipe(ne(1),U(a=>a.runtimes[a.blocks.get(a[h?"best":"finalized"]).runtime].runtime),S(a=>a.dynamicBuilder.buildStorage(c,u).keys.enc(...l))).pipe(ne(1),U(a=>d(c,u,a)),S(({block:{hash:a,number:f,parent:p},deltas:v,entries:b},y)=>{const g=y>0?v:{deleted:[],upserted:b};return{block:{hash:a,number:f,parent:p},entries:b.map(Zr),deltas:g&&{deleted:g.deleted.map(Zr),upserted:g.upserted.map(Zr)}}}))}},Zr=e=>e.dec,sc="RuntimeViewFunction",oc="execute_view_function",Jr=sc+"_"+oc,_h=(e,t,n,{isCompatible:r,getCompatibilityLevel:s,compatibleRuntime$:o,argsAreCompatible:i,valuesAreCompatible:c})=>{const u=()=>new Error(`Incompatible runtime entry ViewFn(${e}.${t})`);return Object.assign((...l)=>{const h=l[l.length-1],d=Rt(h),{signal:a,at:f}=d?h:{},p=f??null,v=o(n,p).pipe(U(([b,y])=>{let g;try{g=y.dynamicBuilder.buildRuntimeCall(sc,oc)}catch{throw new Error(`Runtime entry RuntimeCall(${Jr}) not found`)}let w;try{w=y.dynamicBuilder.buildViewFn(e,t)}catch{throw new Error(`Runtime entry ViewFn(${e}.${t}) not found`)}if(!i(b,y,l))throw u();const m=w.args.enc(l),x=re(le(y.lookup.metadata.pallets.find(({name:k})=>k===e).viewFns.find(({name:k})=>k===t).id),_.enc(m.length),m);return n.call$(p,Jr,J(x)).pipe(S(k=>{try{const B=g.value.dec(k);if(!("success"in B&&"value"in B)||!("type"in B.value)&&!("asBytes"in B.value))throw null;return B}catch{throw new Error(`Unexpected RuntimeCall(${Jr}) type`)}}),S(({success:k,value:B})=>{if(!k)throw new Error(`ViewFn API Error: ${B.type}`);const C=w.value.dec(B.asBytes());if(!c(b,y,C))throw u();return C}))}));return Kn(v,a)},{getCompatibilityLevel:s,isCompatible:r})},ic=(e,t,n)=>{const r={},s=b=>new Proxy(r,{get(y,g){return b(g)}}),o=b=>{const y={};return s(g=>(y[g]||(y[g]={}),s(w=>(y[g][w]||(y[g][w]=b(g,w)),y[g][w]))))},i=(b,y)=>b.lookup.metadata.pallets.find(g=>g.name===y),c=Bh(t.pinnedBlocks$,t.storage$,t.withRuntime),u=o((b,y)=>Yf(b,y,t,c,Et(e,g=>g.getEntryPoint(ft.Storage,b,y),g=>{const w=i(g,b)?.storage?.items.find(m=>m.name===y);return w==null?null:$u(w)}))),l=(b,y,g,w)=>{if(g==null)return null;const m=b.lookup(g);if(m.type!=="enum")throw new Error("Expected enum");if(m.value[w]==null)return null;const x=Ou(m.value[w]);return{args:y==="args"?x:Sn,values:y==="args"?Sn:x}},h=o((b,y)=>Qi(b,y,t,n,Et(e,g=>g.getEntryPoint(ft.Tx,b,y),g=>l(g,"args",i(g,b)?.calls?.type,y)),!0)),d=o((b,y)=>Kf(b,y,t,Et(e,g=>g.getEntryPoint(ft.Event,b,y),g=>l(g,"values",i(g,b)?.events?.type,y)))),a=o((b,y)=>zf(b,y,Et(e,g=>g.getEntryPoint(ft.Const,b,y),g=>{const w=i(g,b)?.constants.find(m=>m.name===y)?.type;return w==null?null:Tu(w)}))),f=o((b,y)=>Xf(b,y,t,Et(e,g=>g.getEntryPoint(ft.Api,b,y),g=>Do(g.lookup.metadata.apis.find(w=>w.name===b).methods.find(w=>w.name===y))))),p=o((b,y)=>_h(b,y,t,Et(e,g=>g.getEntryPoint(ft.ViewFns,b,y),g=>Do(g.lookup.metadata.pallets.find(w=>w.name===b).viewFns.find(w=>w.name===y))))),v=(b,y)=>{const{lookup:g,dynamicBuilder:w}=Vr(y).runtime();try{const m=w.buildDefinition(g.call).dec(b.asBytes()),x=m.type,k=m.value.type,B=m.value.value;return Qi(x,k,t,n,Et(e,C=>C.getEntryPoint(ft.Tx,x,k),C=>l(C,"args",i(C,x)?.calls?.type,k)),!1)(B)}catch{throw new Error("createTx: invalid call data")}};return{query:u,txFromCallData:(b,y)=>y?v(b,y):e.then(g=>v(b,g)),tx:h,event:d,apis:f,constants:a,view:p}};function Ch(e,{getMetadata:t,setMetadata:n}={}){const r=ef(e),s=Uf(r,{getMetadata:t?v=>xt(t(v)):void 0,setMetadata:n}),{getChainSpecData:o}=r,{genesis$:i,...c}=s.chainHead$(),u={...c,genesis$:Tn(o).pipe(S(({genesisHash:v})=>v),Je(()=>i),Rn(1))},l=r.request;let h;const d=new WeakMap,a=v=>{const b=d.get(v)||jf(v,u);return d.set(v,b),b},f=()=>h??(h=Ff(u)),{broadcastTx$:p}=s;return{getChainSpecData:o,blocks$:u.newBlocks$,finalizedBlock$:u.finalized$,getFinalizedBlock:()=>Ve(u.finalized$),bestBlocks$:u.bestBlocks$,getBestBlocks:()=>Ve(u.bestBlocks$),watchBlockBody:u.body$,getBlockBody:v=>Ve(u.body$(v)),getBlockHeader:v=>Ve(u.header$(v??null)),submit:(...v)=>Ni(u,p,...v),submitAndWatch:(...v)=>Gr(u,p,...v),getTypedApi:v=>{const b=a(v);return Object.assign(ic(b,u,p),{compatibilityToken:b})},getUnsafeApi:()=>{const v=f();return Object.assign(ic(v,u,p),{runtimeToken:v})},destroy:()=>{u.unfollow(),s.destroy()},_request:l}}const $h=(e,t,n,r,s)=>{let o;try{o=r.buildCall(e,t)}catch{throw new Error(`Runtime entry Tx(${e}.${t}) not found`)}const{location:i,codec:c}=o,u=new Uint8Array(i);return l=>{const h=Fe.fromBytes(re(u,c.enc(l)));return{encodedData:h,decodedCall:bt(e,bt(t,l)),sign:async(d,a)=>J(await d.signTx(h.asBytes(),s(a),n,a.mortality.mortal?a.mortality.startAtBlock.height:0))}}},Oh=async({genesis:e,getMetadata:t})=>{if(!e)throw new Error("Missing genesis hash");const n=le(e),r=await t(),s=Xt(yt.dec(r)),o=Hn(s),i=Mr(o),c=Yi(n,o,i),u=p=>s.pallets.find(v=>v.name===p),l={},h=p=>new Proxy(l,{get(v,b){return p(b)}}),d=p=>{const v={};return h(b=>(v[b]||(v[b]={}),h(y=>(v[b][y]||(v[b][y]=p(b,y)),v[b][y]))))},a=d((p,v)=>{const b=u(p)?.constants.find(y=>y.name===v);if(!b)throw new Error(`Runtime entry Constant(${p}.${v}) not found`);return i.buildConstant(p,v).dec(b.value)}),f=d((p,v)=>$h(p,v,r,i,c));return{constants:a,tx:f}},sn=(e,t)=>(n,r)=>{try{return e(n,r)}catch{throw new Error(`Runtime entry ${t}(${n}.${r}) not found`)}},Th=async e=>{const t=Xt(dr(await e.getMetadata())),n={},r=d=>new Proxy(n,{get(a,f){return d(f)}}),s=d=>{const a={};return r(f=>(a[f]||(a[f]={}),r(p=>(a[f][p]||(a[f][p]=d(f,p)),a[f][p]))))},o=Hn(t),{buildRuntimeCall:i,buildStorage:c,buildConstant:u,buildCall:l,buildEvent:h}=Mr(o);return{query:s((...d)=>{const{value:a,args:f}=sn(c,"Storage")(...d);return{value:a,args:f}}),tx:s((...d)=>sn(l,"Call")(...d).codec),event:s((...d)=>sn(h,"Event")(...d).codec),apis:s(sn(i,"Runtime API")),constants:s(sn(u,"Constant"))}};ce.AccountId=pt,ce.Binary=Fe,ce.CompatibilityLevel=Be,ce.Enum=bt,ce.FixedSizeBinary=mn,ce.InvalidTxError=Yr,ce._Enum=Js,ce.createClient=Ch,ce.getOfflineApi=Oh,ce.getSs58AddressInfo=nr,ce.getTypedCodecs=Th});
